(function(e){function s(s){for(var a,n,i=s[0],l=s[1],d=s[2],u=0,f=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&f.push(o[n][0]),o[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(s);while(f.length)f.shift()();return r.push.apply(r,d||[]),t()}function t(){for(var e,s=0;s<r.length;s++){for(var t=r[s],a=!0,i=1;i<t.length;i++){var l=t[i];0!==o[l]&&(a=!1)}a&&(r.splice(s--,1),e=n(n.s=t[0]))}return e}var a={},o={app:0},r=[];function n(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=a,n.d=function(e,s,t){n.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,s){if(1&s&&(e=n(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)n.d(t,a,function(s){return e[s]}.bind(null,a));return t},n.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(s,"a",s),s},n.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},n.p="/app-web-admin/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=s,i=i.slice();for(var d=0;d<i.length;d++)s(i[d]);var c=l;r.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"034f":function(e,s,t){"use strict";var a=t("85ec"),o=t.n(a);o.a},"058e":function(e,s,t){},"0c59":function(e,s,t){},1:function(e,s){},"10b4":function(e,s,t){},"11cf":function(e,s,t){},"13fd":function(e,s,t){"use strict";var a=t("3a9d"),o=t.n(a);o.a},2:function(e,s){},3:function(e,s){},"3a9d":function(e,s,t){},4:function(e,s){},"40e5":function(e,s,t){"use strict";var a=t("48d5"),o=t.n(a);o.a},"48d5":function(e,s,t){},5:function(e,s){},5038:function(e,s,t){},5241:function(e,s,t){"use strict";var a=t("11cf"),o=t.n(a);o.a},"56d7":function(e,s,t){"use strict";t.r(s);var a=t("2b0e"),o=t("5f5b"),r=t("b1e0");t("ab8b"),t("2dd8");a["default"].use(o["a"]),a["default"].use(r["a"]);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("NavBar",{attrs:{loggedIn:e.loggedIn},on:{loggedOut:function(s){e.loggedIn=!1}}}),t("router-view",{on:{loggedIn:function(s){e.loggedIn=!0},loggedOut:function(s){e.loggedIn=!1}}})],1)},i=[],l=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",[a("b-navbar",{attrs:{toggleable:"lg",type:"light",variant:"info",fixed:"top"}},[a("b-navbar-brand",{attrs:{href:"https://api.pryv.com"}},[a("img",{attrs:{alt:"Logo",src:t("cf05")}})]),a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),e.loggedIn?a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{attrs:{align:"left",tag:"div"}},[e.canViewPlatformConfig?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/platform-config"}},[e._v("Platform Configuration")]):e._e(),e.canViewUsersManagement?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/users-management"}},[e._v("Users Management")]):e._e()],1),a("b-navbar-nav",{attrs:{align:"right",tag:"div"}},[a("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("em",[e._v("Profile")])]},proxy:!0}],null,!1,2313340923)},[a("b-dropdown-item",{on:{click:function(s){e.displayChangePasswordModal=!0}}},[e._v("Change Password")]),a("b-dropdown-item",{on:{click:function(s){return e.logout()}}},[e._v("Sign Out")])],1)],1)],1):e._e()],1),a("transition",{attrs:{name:"modal"}},[e.displayChangePasswordModal?a("PasswordChangeModal",{on:{close:function(s){e.displayChangePasswordModal=!1}}}):e._e()],1)],1)},d=[],c=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Enter new password")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.requestPasswordChange(s)}}},[t("b-form-group",{attrs:{"label-for":"oldPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"oldPassword",id:"oldPassword",placeholder:"Old Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.oldPassword,callback:function(s){e.oldPassword=s},expression:"oldPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPassword",id:"newPassword",placeholder:"New Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPassword,callback:function(s){e.newPassword=s},expression:"newPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPasswordCheck"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPasswordCheck",id:"newPasswordCheck",placeholder:"Confirm Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPasswordCheck,callback:function(s){e.newPasswordCheck=s},expression:"newPasswordCheck"}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.passwordChangeFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Password change failed")]),t("p",[e._v("Please try again later")])])]):e._e(),e.passwordChangeSuccessful?t("b-card",[t("div",{staticClass:"success-msg"},[t("p",[e._v("Password successfully changed")])])]):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showPasswordChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.passwordChangedText},on:{close:function(s){return e.$emit("close")}}}):e._e()],1),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e()],1)},u=[],f=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"modal-mask"},[t("div",{staticClass:"modal-wrapper"},[t("div",{staticClass:"modal-container"},[t("div",{staticClass:"modal-header"},[e._t("header",[e._v(" "+e._s(e.header))]),t("div",{staticClass:"close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")])],2),t("div",{staticClass:"modal-body"},[e._t("body",[e._v(e._s(e.body))])],2),t("div",{staticClass:"modal-footer"},[e._t("footer",[e.showCancelButton?t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]):e._e(),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("close")}}},[e._v("OK")]),t("br")])],2)])])])},p=[],m={name:"Modal",props:{header:String,body:String,showCancelButton:Boolean}},h=m,g=(t("d08b"),t("2877")),b=Object(g["a"])(h,f,p,!1,null,"9689ad1e",null),v=b.exports,w=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-successful-modal-mask"},[t("div",{staticClass:"operation-successful-modal-wrapper"},[t("div",{staticClass:"operation-successful-modal-container"},[t("div",{staticClass:"operation-successful-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"success"}}),t("b-icon",{attrs:{stacked:"",icon:"check",variant:"success"}})],1),t("div",{staticClass:"operation-successful-modal-message"},[e._v(e._s(e.text))]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Close ")])],1)])])])},C=[],P={name:"OperationSuccessfulModal",props:{text:String}},_=P,y=(t("df64"),Object(g["a"])(_,w,C,!1,null,"0f12b945",null)),M=y.exports,U=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-failed-modal-mask"},[t("div",{staticClass:"operation-failed-modal-wrapper",on:{click:function(s){return e.$emit("close")}}},[t("div",{staticClass:"operation-failed-modal-container"},[t("div",{staticClass:"operation-failed-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"danger"}}),t("b-icon",{attrs:{stacked:"",icon:"x",variant:"danger"}})],1),t("div",{staticClass:"operation-failed-modal-message"},[e._v(" Failed to process the request. Verify your input or try again later ")])],1)])])])},k=[],x={name:"OperationFailedModal"},S=x,O=(t("b24f"),Object(g["a"])(S,U,k,!1,null,"e9f76e9c",null)),$=O.exports,R=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"loader-mask"},[t("div",{staticClass:"loader-wrapper"},[t("pulse-loader")],1)])},I=[],E=t("8a5d"),j={name:"Loader",components:{PulseLoader:E["a"]}},F=j,L=(t("d609"),Object(g["a"])(F,R,I,!1,null,"97a2206a",null)),D=L.exports;const T=t("bc3a"),B=t("04e1");var N={name:"PasswordChangeModal",components:{Modal:v,OperationSuccessfulModal:M,OperationFailedModal:$,Loader:D},data:()=>({oldPassword:"",newPassword:"",newPasswordCheck:"",passwordChangeFailed:!1,passwordChangeSuccessful:!1,passwordProvided:!0,passwordChangedText:"Password changed successfully",showPasswordChangedModal:!1,showFailureModal:!1,showLoader:!1}),methods:{requestPasswordChange:function(){this.showLoader=!0;const e=localStorage.getItem("token"),s=B(e).username;T.post(`/users/${s}/change-password`,{oldPassword:this.oldPassword,newPassword:this.newPassword,newPasswordCheck:this.newPasswordCheck}).then(()=>{this.showPasswordChangedModal=!0}).catch(()=>{this.showFailureModal=!0}).finally(()=>this.showLoader=!1)}}},A=N,q=(t("13fd"),Object(g["a"])(A,c,u,!1,null,"683d2546",null)),J=q.exports;const H=function(e){const s=JSON.parse(localStorage.getItem("permissions"));return s&&s[e]&&Array.isArray(s[e])?s[e]:[]};class V{static canReadSettings(){return H("settings").includes("read")}static canUpdateSettings(){return H("settings").includes("update")}static canReadUsers(){return H("users").includes("read")}static canDeleteUsers(){return H("users").includes("delete")}static canResetPassword(){return H("users").includes("resetPassword")}static canChangePermissions(){return H("users").includes("changePermissions")}}const z=t("bc3a");var G={name:"NavBar",components:{PasswordChangeModal:J},props:{loggedIn:Boolean},data:()=>({displayChangePasswordModal:!1}),computed:{canViewPlatformConfig:()=>V.canReadSettings(),canViewUsersManagement:()=>V.canReadUsers()},methods:{logout:function(){z.post("/auth/logout",{}).finally(()=>{localStorage.removeItem("token"),this.$emit("loggedOut"),this.$router.push("/login")})}}},K=G,Y=(t("e136"),Object(g["a"])(K,l,d,!1,null,"109cac78",null)),Q=Y.exports;const W=t("bc3a");var X={name:"App",components:{NavBar:Q},data:()=>({loggedIn:!1}),beforeMount(){this.loggedIn=!!localStorage.getItem("token"),this.loggedIn&&(W.defaults.baseURL=localStorage.getItem("serverUrl"),W.defaults.headers.common["authorization"]=localStorage.getItem("token"))}},Z=X,ee=(t("034f"),Object(g["a"])(Z,n,i,!1,null,null,null)),se=ee.exports,te=t("8c4f"),ae=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"home"})},oe=[],re={name:"Home",beforeMount(){localStorage.getItem("token")?(V.canReadSettings()||V.canReadUsers())&&this.$router.push("/platform-config"):this.$router.push("/login")}},ne=re,ie=Object(g["a"])(ne,ae,oe,!1,null,null,null),le=ie.exports,de=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"users-management"},[t("h2",[e._v("Users Management")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve users list from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),t("b-table",{attrs:{striped:"",hover:"","sticky-header":"49em",responsive:"",fixed:"",selectable:"","select-mode":"single","head-variant":"light",items:e.usersList,fields:e.tableHeaders,"primary-key":"username"},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(users)",fn:function(s){return[e._v(" "+e._s(s.item.username)+" ")]}},{key:"cell(permissions)",fn:function(e){return[t("PermissionsTable",{attrs:{permissions:e.item.permissions,disableCheckBoxes:!0}})]}}])}),t("b-card",[Object.keys(e.selectedUser).length>0?t("b-button",{attrs:{variant:"info"},on:{click:function(s){e.showEditUserModal=!0}}},[e._v(" Edit ")]):e._e(),t("b-button",{attrs:{variant:"success"},on:{click:function(s){e.showCreateUserModal=!0}}},[e._v(" Create ")])],1),t("transition",{attrs:{name:"modal"}},[e.showEditUserModal?t("CreateEditUserModal",{attrs:{edit:!0,username:e.selectedUser.username,permissions:Object.assign({},e.selectedUser.permissions)},on:{close:function(s){e.showEditUserModal=!1},permissionsChanged:function(s){return e.onPermissionsChanged(s,e.selectedUser.username)},passwordResetDone:function(s){return e.onPasswordResetDone(s)},userDeleted:function(s){return e.onUserDeleted()}}}):e._e()],1),e.loadInProgress?t("loader",{attrs:{loading:e.loadInProgress}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showCreateUserModal?t("CreateEditUserModal",{attrs:{create:!0,permissions:{users:[],settings:[]}},on:{close:function(s){e.showCreateUserModal=!1},userCreated:function(s){return e.onUserCreated(s)}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPermissionsChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPermissionsChangedText},on:{close:function(s){return e.onUsersPermissionsChangedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPasswordResetedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPasswordResetedText},on:{close:function(s){return e.onUsersPasswordResetedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserDeletedModal?t("OperationSuccessfulModal",{attrs:{text:e.userDeletedText},on:{close:function(s){return e.onUserDeletedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserCreatedModal?t("OperationSuccessfulModal",{attrs:{text:e.userCreatedText},on:{close:function(s){return e.onUserCreatedModalClose()}}}):e._e()],1)],1)},ce=[],ue=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"create-edit-user-modal"},[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.headerStart)+" user")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.saveChanges(s)}}},[t("b-form-group",{attrs:{label:"Username"}},[t("b-form-input",{attrs:{required:"",disabled:e.edit,type:"text",name:"username",id:"username",placeholder:"Username"},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),e.create?t("b-form-group",{attrs:{label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"password",id:"password",placeholder:"Password"},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1):e._e(),t("b-form-group",{attrs:{label:"Permissions"}},[t("br"),t("PermissionsTable",{attrs:{permissions:e.permissions,disableCheckBoxes:e.edit&&!e.canChangePermissions}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.edit?t("div",[t("hr"),e.canResetPassword?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showResetPasswordConfirmationModal=!0}}},[e._v(" Reset password ")]):e._e(),e.canDelete?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showDeleteConfirmationModal=!0}}},[e._v(" Delete ")]):e._e()],1):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showResetPasswordConfirmationModal?t("ConfirmationModal",{attrs:{text:e.resetPasswordConfirmationMsg},on:{close:function(s){e.showResetPasswordConfirmationModal=!1},confirm:function(s){return e.resetPassword()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showDeleteConfirmationModal?t("ConfirmationModal",{attrs:{text:e.deleteConfirmationMsg},on:{close:function(s){e.showDeleteConfirmationModal=!1},confirm:function(s){return e.deleteUser()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1)],1)},fe=[],pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"permissions-table"},[t("table",[e._m(0),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[e._v(" "+e._s(s)+" ")])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"settings-perm-"+s},[e._v(" "+e._s(s)+" ")])}))],2),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.users,expression:"permissions.users"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.users)?e._i(e.permissions.users,s)>-1:e.permissions.users},on:{change:function(t){var a=e.permissions.users,o=t.target,r=!!o.checked;if(Array.isArray(a)){var n=s,i=e._i(a,n);o.checked?i<0&&e.$set(e.permissions,"users",a.concat([n])):i>-1&&e.$set(e.permissions,"users",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"users",r)}}})])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"setttings-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.settings,expression:"permissions.settings"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.settings)?e._i(e.permissions.settings,s)>-1:e.permissions.settings},on:{change:function(t){var a=e.permissions.settings,o=t.target,r=!!o.checked;if(Array.isArray(a)){var n=s,i=e._i(a,n);o.checked?i<0&&e.$set(e.permissions,"settings",a.concat([n])):i>-1&&e.$set(e.permissions,"settings",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"settings",r)}}})])}))],2)])])},me=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("tr",{staticClass:"perms-table-row"},[t("th",{attrs:{colspan:"5"}},[e._v("USERS")]),t("th",{attrs:{colspan:"2"}},[e._v("SETTINGS")])])}],he={name:"PermissionsTable",props:{permissions:{},disableCheckBoxes:Boolean},data:()=>({settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"]})},ge=he,be=(t("cf07"),Object(g["a"])(ge,pe,me,!1,null,"970661e2",null)),ve=be.exports,we=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"confirmation-modal-mask"},[t("div",{staticClass:"confirmation-modal-wrapper"},[t("div",{staticClass:"confirmation-modal-container"},[t("div",{staticClass:"confirmation-modal-body"},[t("div",{staticClass:"confirmation-close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")]),t("div",{staticClass:"confirmation-text"},[e._v(e._s(e.text))])]),t("div",{staticClass:"confirmation-modal-footer"},[t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("confirm")}}},[e._v("Yes")]),t("br")],1)])])])},Ce=[],Pe={name:"ConfirmationModal",props:{text:String}},_e=Pe,ye=(t("63a0"),Object(g["a"])(_e,we,Ce,!1,null,"b96c0804",null)),Me=ye.exports;const Ue=t("4556"),ke=t("bc3a"),{handleHttpErrors:xe}=t("dc5b");var Se={name:"CreateEditUserModal",props:{edit:Boolean,create:Boolean,username:String,permissions:{}},components:{Modal:v,PermissionsTable:ve,ConfirmationModal:Me,Loader:D,OperationFailedModal:$},data:function(){return{password:"",showResetPasswordConfirmationModal:!1,showDeleteConfirmationModal:!1,resetPasswordConfirmationMsg:"Are you sure you want to reset the password of this user?",deleteConfirmationMsg:"Are you sure you want to delete this user?",showLoader:!1,showFailureModal:!1}},computed:{headerStart:function(){return this.edit?"Edit":"Create"},canChangePermissions:()=>V.canChangePermissions(),canResetPassword:()=>V.canResetPassword(),canDelete:()=>V.canDeleteUsers()},methods:{saveChanges:function(){this.create?this.createUser():this.edit&&this.changePermissions()},createUser(){this.showLoader=!0,ke.post("/users",{username:this.username,password:this.password,permissions:this.permissions}).then(()=>{this.$emit("userCreated",{username:this.username,password:this.password})}).catch(e=>{xe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},changePermissions(){this.showLoader=!0,ke.put(`/users/${this.username}/permissions`,{permissions:this.permissions}).then(()=>{this.$emit("permissionsChanged",this.permissions)}).catch(e=>{xe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},resetPassword(){this.showResetPasswordConfirmationModal=!1,this.showLoader=!0,ke.post(`/users/${this.username}/reset-password`,{}).then(e=>{this.$emit("passwordResetDone",e.data)}).catch(e=>{xe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},deleteUser(){this.showDeleteConfirmationModal=!1,this.showLoader=!0,ke.delete("/users/"+this.username).catch(e=>{xe(e,this)||(this.showFailureModal=!0)}).then(()=>{this.$emit("userDeleted")}).finally(()=>this.showLoader=!1)}},beforeMount(){this.password=Ue({length:10,type:"url-safe"})}},Oe=Se,$e=(t("5fc0"),Object(g["a"])(Oe,ue,fe,!1,null,"af559112",null)),Re=$e.exports;const Ie=t("bc3a"),{handleHttpErrors:Ee}=t("dc5b");var je={name:"UsersManagement",components:{Loader:D,CreateEditUserModal:Re,PermissionsTable:ve,OperationSuccessfulModal:M},data:()=>({usersList:[],loadFailed:!1,loadInProgress:!1,selectedUser:{},tableHeaders:[{key:"users",label:"Username",thStyle:{"padding-left":"60px"},class:"users-management-user-row"},{key:"permissions",label:"Permissions",thStyle:{"padding-left":"60px"}}],settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"],showCreateUserModal:!1,showEditUserModal:!1,showUserDeletedModal:!1,userDeletedText:"User deleted successfully",showUserCreatedModal:!1,userCreatedInitialText:"User created successfully.",userCreatedText:"",showUsersPasswordResetedModal:!1,usersPasswordResetedInitialText:"User's password reset successful.",usersPasswordResetedText:"",showUsersPermissionsChangedModal:!1,usersPermissionsChangedText:"User's permissions updated successfully"}),methods:{onUsersPermissionsChangedModalClose:function(){this.showUsersPermissionsChangedModal=!1,this.showEditUserModal=!1},onUsersPasswordResetedModalClose:function(){this.showUsersPasswordResetedModal=!1,this.showEditUserModal=!1},onUserDeletedModalClose:function(){this.showUserDeletedModal=!1,this.showEditUserModal=!1},onUserCreatedModalClose:function(){this.showUserCreatedModal=!1,this.showCreateUserModal=!1},onPasswordResetDone:function(e){this.usersPasswordResetedText=`${this.usersPasswordResetedInitialText} New password: ${e.password}`,this.showUsersPasswordResetedModal=!0},onRowSelected:function(e){e&&e.length>0?this.selectedUser=e[0]:this.selectedUser=""},onUserCreated:function(e){this.userCreatedText=`${this.userCreatedInitialText} username: ${e.username} \n password: ${e.password}`,this.showUserCreatedModal=!0,this.getUsersList()},onUserDeleted:function(){this.showUserDeletedModal=!0,this.getUsersList()},onPermissionsChanged:function(e,s){this.showUsersPermissionsChangedModal=!0,this.usersList.find(e=>e.username===s).permissions=e},getUsersList:function(){this.loadInProgress=!0,Ie.get("/users").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;this.usersList=e.data}).catch(e=>{Ee(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})}},beforeMount(){this.getUsersList()}},Fe=je,Le=(t("40e5"),Object(g["a"])(Fe,de,ce,!1,null,"60eb546f",null)),De=Le.exports,Te=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"platform-config"},[t("h2",[e._v("Platform Configuration")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve configuration from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),e.updateInProgress||e.loadInProgress?t("loader",{attrs:{loading:e.updateInProgress}}):e._e(),e.updateFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to update configuration.")]),t("p",[e._v("Verify provided information or try again later.")])])]):e._e(),t("br"),t("b-card",{attrs:{"no-body":""}},[0!==Object.keys(e.config).length?t("b-tabs",{attrs:{pills:"",justified:"",card:""}},e._l(e.config,(function(s,a){return t("b-tab",{key:a,attrs:{"title-link-class":"tab-title",title:s.name}},[t("ConfigTable",{attrs:{initialConfigSection:a,valuesEditable:e.canUpdateSettings}})],1)})),1):e._e()],1),0!==Object.keys(e.config).length&&e.canUpdateSettings?t("b-card",[t("b-button",{attrs:{variant:"success"},on:{click:e.updateConfig}},[e._v("Update ")])],1):e._e(),t("transition",{attrs:{name:"modal"}},[e.showModal?t("UpdateReportModal",{attrs:{updateReport:e.updateConfigReport},on:{updateReportModalClosed:function(s){e.showModal=!1}}}):e._e()],1)],1)},Be=[],Ne=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"config-table"},[t("b-table",{attrs:{striped:"",hover:"","sticky-header":"45em",responsive:"",fixed:"","head-variant":"light",items:e.displayConfig},scopedSlots:e._u([{key:"cell(property)",fn:function(s){return[t("div",{staticClass:"tab-cell"},[e._v(e._s(s.item.property))])]}},{key:"cell(value)",fn:function(s){return[t("b-form-input",{attrs:{disabled:!e.valuesEditable},on:{blur:function(t){return e.onValueChanged(t,s.item.property)}},model:{value:s.item.value,callback:function(t){e.$set(s.item,"value",t)},expression:"row.item.value"}})]}},{key:"cell(description)",fn:function(s){return[t("div",{staticClass:"tab-cell"},[e._v(e._s(s.item.description))])]}}])})],1)},Ae=[],qe=a["default"].observable({state:{config:{}}}),Je={name:"ConfigTable",props:{initialConfigSection:String,valuesEditable:Boolean},data:function(){return{configSection:this.initialConfigSection}},computed:{canUpdateSettings:()=>V.canUpdateSettings(),config:function(){return qe.state.config[this.configSection].settings},displayConfig:function(){return Object.keys(this.config).map(function(e){const s=this.config[e].description?this.config[e].description:null;let t=this.config[e];return Object.prototype.hasOwnProperty.call(t,"value")&&(t=t.value),t||"boolean"===typeof t?"object"===typeof t?t=JSON.stringify(t):"string"!==typeof t&&(t=String(t)):t="",{property:e,value:t,description:s}}.bind(this))}},methods:{onValueChanged:function(e,s){let t=this.displayConfig.find(e=>e.property===s).value;this.isJSON(t)&&(t=JSON.parse(t)),this.config[s].value=t},isJSON:function(e){try{JSON.parse(e)}catch(s){return!1}return!0}}},He=Je,Ve=(t("696b"),Object(g["a"])(He,Ne,Ae,!1,null,"96b93c06",null)),ze=Ve.exports,Ge=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("Modal",{on:{close:function(s){return e.$emit("updateReportModalClosed")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Update report")]),t("div",{attrs:{slot:"body"},slot:"body"},[Object.keys(e.updateReport.successes).length>0?t("div",[t("h4",[e._v("Successes")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.successes}})],1):e._e(),Object.keys(e.updateReport.failures).length>0?t("div",[t("h4",[e._v("Failures")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.failures}})],1):e._e()])])},Ke=[],Ye={name:"UpdateReportModal",components:{Modal:v},props:{updateReport:{}},computed:{successes:function(){return Object.keys(this.updateReport.successes).map(function(e){return{url:this.updateReport.successes[e].url,role:this.updateReport.successes[e].role}}.bind(this))},failures:function(){return Object.keys(this.updateReport.failures).map(function(e){return{url:this.updateReport.failures[e].url,role:this.updateReport.failures[e].role}}.bind(this))}}},Qe=Ye,We=(t("d189"),Object(g["a"])(Qe,Ge,Ke,!1,null,"247b1916",null)),Xe=We.exports;const Ze=t("bc3a"),{handleHttpErrors:es}=t("dc5b");var ss={name:"Config",components:{ConfigTable:ze,UpdateReportModal:Xe,Loader:D},data:()=>({loadFailed:!1,updateFailed:!1,showModal:!1,updateConfigReport:{},updateInProgress:!1,loadInProgress:!1}),computed:{config:()=>qe.state.config,canUpdateSettings:()=>V.canUpdateSettings()},methods:{getConfig:function(){qe.state.config={},this.loadInProgress=!0,Ze.get("/admin/settings").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;qe.state.config=e.data}).catch(e=>{es(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})},updateConfig:function(){this.updateInProgress=!0,this.updateFailed=!1,Ze.put("/admin/settings",qe.state.config).then(()=>Ze.post("/admin/notify",{})).then(e=>{if(!e.data||!Object.hasOwnProperty.call(e.data,"successes")||!Object.hasOwnProperty.call(e.data,"failures"))throw new Error;this.updateConfigReport=e.data,this.showModal=!0}).catch(()=>{this.updateFailed=!0}).finally(()=>{this.updateInProgress=!1})},resetFailureIndicators:function(){this.loadFailed=!1,this.updateFailed=!1}},beforeMount(){this.getConfig()}},ts=ss,as=(t("5241"),Object(g["a"])(ts,Te,Be,!1,null,"12ab0b52",null)),os=as.exports,rs=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"login"},[t("h1",[e._v("Administration Panel")]),t("h3",[e._v("Please log in")]),t("b-card",[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.login(s)}}},[t("b-form-group",{attrs:{"label-for":"serverUrl",label:"Config leader address"}},[t("b-form-input",{attrs:{required:"",pattern:"https?://\\S+",type:"text",name:"serverUrl",id:"serverUrl",placeholder:"https://lead.platform.com"},on:{input:function(s){e.loginFailed=!1}},model:{value:e.serverUrl,callback:function(s){e.serverUrl=s},expression:"serverUrl"}})],1),t("b-form-group",{attrs:{"label-for":"username",label:"Username"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"username",id:"username",placeholder:"Username"},on:{input:function(s){e.loginFailed=!1}},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),t("b-form-group",{attrs:{"label-for":"password",label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Password"},on:{input:function(s){e.loginFailed=!1}},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1),t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v("Login")])],1)],1),e.loginFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Incorrect credentials. Please verify your input")])])]):e._e(),e.loginInProgress?t("loader",{attrs:{loading:e.loginInProgress}}):e._e()],1)},ns=[];const is=t("04e1"),ls=t("bc3a");var ds={name:"Login",components:{Loader:D},data:()=>({serverUrl:"",username:"",password:"",loginFailed:!1,loginInProgress:!1}),methods:{login:function(){this.loginInProgress=!0,ls.post(this.serverUrl+"/auth/login",{username:this.username,password:this.password}).then(e=>{if(!e.data||0===Object.keys(e.data).length||!e.data.token)throw new Error;localStorage.setItem("serverUrl",this.serverUrl),localStorage.setItem("token",e.data.token);const s=is(e.data.token);localStorage.setItem("permissions",JSON.stringify(s.permissions)),localStorage.setItem("username",s.username),localStorage.setItem("serverUrl",this.serverUrl),ls.defaults.baseURL=this.serverUrl,ls.defaults.headers.common["authorization"]=e.data.token,this.$emit("loggedIn"),this.$router.push("/")}).catch(()=>{this.loginFailed=!0}).finally(()=>{this.loginInProgress=!1})}}},cs=ds,us=(t("f076"),Object(g["a"])(cs,rs,ns,!1,null,"5e87327c",null)),fs=us.exports;a["default"].use(te["a"]);const ps=[{path:"/",name:"Home",component:le},{path:"/login",name:"Login",component:fs},{path:"/users-management",name:"UsersManagement",component:De},{path:"/platform-config",name:"Config",component:os}],ms=new te["a"]({routes:ps});var hs=ms;a["default"].config.productionTip=!1,new a["default"]({router:hs,render:e=>e(se)}).$mount("#app")},"5fc0":function(e,s,t){"use strict";var a=t("adbf"),o=t.n(a);o.a},6:function(e,s){},"63a0":function(e,s,t){"use strict";var a=t("c8da"),o=t.n(a);o.a},"696b":function(e,s,t){"use strict";var a=t("5038"),o=t.n(a);o.a},7:function(e,s){},8:function(e,s){},"82b4":function(e,s,t){},"85ec":function(e,s,t){},9:function(e,s){},"94d2":function(e,s,t){},"9da0":function(e,s,t){},adbf:function(e,s,t){},b24f:function(e,s,t){"use strict";var a=t("fced"),o=t.n(a);o.a},c8da:function(e,s,t){},cf05:function(e,s,t){e.exports=t.p+"img/logo.54cacaa3.png"},cf07:function(e,s,t){"use strict";var a=t("82b4"),o=t.n(a);o.a},d08b:function(e,s,t){"use strict";var a=t("10b4"),o=t.n(a);o.a},d189:function(e,s,t){"use strict";var a=t("0c59"),o=t.n(a);o.a},d609:function(e,s,t){"use strict";var a=t("9da0"),o=t.n(a);o.a},dc5b:function(e,s,t){"use strict";t.r(s),t.d(s,"handleHttpErrors",(function(){return a}));const a=function(e,s){if(e&&e.response)return 401===e.response.status&&"Invalid token"===e.response.data.error.message&&(localStorage.removeItem("token"),s.$emit("loggedOut"),s.$router.push("/login"),!0)}},df64:function(e,s,t){"use strict";var a=t("058e"),o=t.n(a);o.a},e136:function(e,s,t){"use strict";var a=t("94d2"),o=t.n(a);o.a},f076:function(e,s,t){"use strict";var a=t("f14d"),o=t.n(a);o.a},f14d:function(e,s,t){},fced:function(e,s,t){}});
//# sourceMappingURL=app.84967a39.js.map