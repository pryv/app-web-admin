(function(e){function s(s){for(var a,r,i=s[0],l=s[1],d=s[2],u=0,p=[];u<i.length;u++)r=i[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(s);while(p.length)p.shift()();return o.push.apply(o,d||[]),t()}function t(){for(var e,s=0;s<o.length;s++){for(var t=o[s],a=!0,i=1;i<t.length;i++){var l=t[i];0!==n[l]&&(a=!1)}a&&(o.splice(s--,1),e=r(r.s=t[0]))}return e}var a={},n={app:0},o=[];function r(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=a,r.d=function(e,s,t){r.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,s){if(1&s&&(e=r(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)r.d(t,a,function(s){return e[s]}.bind(null,a));return t},r.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(s,"a",s),s},r.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},r.p="/app-web-admin/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=s,i=i.slice();for(var d=0;d<i.length;d++)s(i[d]);var c=l;o.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"018c":function(e,s,t){},"034f":function(e,s,t){"use strict";var a=t("85ec"),n=t.n(a);n.a},"04e0":function(e,s,t){},"058e":function(e,s,t){},1:function(e,s){},"12cf":function(e,s,t){},2:function(e,s){},2527:function(e,s,t){"use strict";var a=t("04e0"),n=t.n(a);n.a},"2a9d":function(e,s,t){"use strict";var a=t("4d15"),n=t.n(a);n.a},"2bb8":function(e,s,t){},3:function(e,s){},4:function(e,s){},"400e":function(e,s,t){},"4d15":function(e,s,t){},5:function(e,s){},5534:function(e,s,t){},"555a":function(e,s,t){"use strict";var a=t("2bb8"),n=t.n(a);n.a},5643:function(e,s,t){"use strict";var a=t("75c5"),n=t.n(a);n.a},"56d7":function(e,s,t){"use strict";t.r(s);var a=t("2b0e"),n=t("5f5b"),o=t("b1e0");t("ab8b"),t("2dd8");a["default"].use(n["a"]),a["default"].use(o["a"]);var r=t("9aa5"),i=t.n(r);a["default"].directive("linkified",i.a);var l=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("NavBar",{attrs:{loggedIn:e.loggedIn},on:{loggedOut:function(s){e.loggedIn=!1}}}),t("router-view",{on:{loggedIn:function(s){e.loggedIn=!0},loggedOut:function(s){e.loggedIn=!1}}})],1)},d=[],c=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",[a("b-navbar",{attrs:{type:"light",variant:"info",fixed:"top"}},[a("b-navbar-brand",{attrs:{href:"https://api.pryv.com"}},[a("img",{attrs:{alt:"Logo",src:t("cf05")}})]),e.loggedIn?a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}):e._e(),e.loggedIn?a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{staticClass:"ml-auto",attrs:{tag:"div"}},[e.canViewPlatformConfig?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/platform-config"}},[e._v("Platform Configuration")]):e._e(),e.canViewUsersManagement?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/users-management"}},[e._v("Users Management")]):e._e()],1),a("b-navbar-nav",{attrs:{align:"right",tag:"div"}},[a("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("em",[e._v("Profile")])]},proxy:!0}],null,!1,2313340923)},[a("b-dropdown-item",{on:{click:function(s){e.displayChangePasswordModal=!0}}},[e._v("Change Password")]),a("b-dropdown-item",{on:{click:function(s){return e.logout()}}},[e._v("Sign Out")])],1)],1)],1):e._e()],1),a("transition",{attrs:{name:"modal"}},[e.displayChangePasswordModal?a("PasswordChangeModal",{on:{close:function(s){e.displayChangePasswordModal=!1}}}):e._e()],1)],1)},u=[],p=t("bc3a"),m=t.n(p),f=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Enter new password")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.requestPasswordChange(s)}}},[t("b-form-group",{attrs:{"label-for":"oldPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"oldPassword",id:"oldPassword",placeholder:"Old Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.oldPassword,callback:function(s){e.oldPassword=s},expression:"oldPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPassword",id:"newPassword",placeholder:"New Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPassword,callback:function(s){e.newPassword=s},expression:"newPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPasswordCheck"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPasswordCheck",id:"newPasswordCheck",placeholder:"Confirm Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPasswordCheck,callback:function(s){e.newPasswordCheck=s},expression:"newPasswordCheck"}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.passwordChangeFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Password change failed")]),t("p",[e._v("Please try again later")])])]):e._e(),e.passwordChangeSuccessful?t("b-card",[t("div",{staticClass:"success-msg"},[t("p",[e._v("Password successfully changed")])])]):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showPasswordChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.passwordChangedText},on:{close:function(s){return e.$emit("close")}}}):e._e()],1),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e()],1)},h=[],g=t("04e1"),v=t.n(g),b=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"modal-mask"},[t("div",{staticClass:"modal-wrapper"},[t("div",{staticClass:"modal-container"},[t("div",{staticClass:"modal-header"},[e._t("header",[e._v(e._s(e.header))]),t("div",{staticClass:"close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")])],2),t("div",{staticClass:"modal-body"},[e._t("body",[e._v(e._s(e.body))])],2),t("div",{staticClass:"modal-footer"},[e._t("footer",[e.showCancelButton?t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]):e._e(),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("close")}}},[e._v("OK")]),t("br")])],2)])])])},w=[],C={name:"Modal",props:{header:String,body:String,showCancelButton:Boolean}},P=C,_=(t("2527"),t("2877")),y=Object(_["a"])(P,b,w,!1,null,"75ef802d",null),M=y.exports,k=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-successful-modal-mask"},[t("div",{staticClass:"operation-successful-modal-wrapper"},[t("div",{staticClass:"operation-successful-modal-container"},[t("div",{staticClass:"operation-successful-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"success"}}),t("b-icon",{attrs:{stacked:"",icon:"check",variant:"success"}})],1),t("div",{staticClass:"operation-successful-modal-message"},[e._v(e._s(e.text))]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Close ")])],1)])])])},U=[],x={name:"OperationSuccessfulModal",props:{text:String}},S=x,O=(t("df64"),Object(_["a"])(S,k,U,!1,null,"0f12b945",null)),R=O.exports,I=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-failed-modal-mask"},[t("div",{staticClass:"operation-failed-modal-wrapper",on:{click:function(s){return e.$emit("close")}}},[t("div",{staticClass:"operation-failed-modal-container"},[t("div",{staticClass:"operation-failed-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"danger"}}),t("b-icon",{attrs:{stacked:"",icon:"x",variant:"danger"}})],1),t("div",{staticClass:"operation-failed-modal-message"},[e._v(" Failed to process the request. Verify your input or try again later ")])],1)])])])},$=[],F={name:"OperationFailedModal"},E=F,T=(t("b24f"),Object(_["a"])(E,I,$,!1,null,"e9f76e9c",null)),j=T.exports,L=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"loader-mask"},[t("div",{staticClass:"loader-wrapper"},[t("pulse-loader")],1)])},D=[],N=t("8a5d"),V={name:"Loader",components:{PulseLoader:N["a"]}},J=V,q=(t("d609"),Object(_["a"])(J,L,D,!1,null,"97a2206a",null)),B=q.exports,A={name:"PasswordChangeModal",components:{Modal:M,OperationSuccessfulModal:R,OperationFailedModal:j,Loader:B},data:()=>({oldPassword:"",newPassword:"",newPasswordCheck:"",passwordChangeFailed:!1,passwordChangeSuccessful:!1,passwordProvided:!0,passwordChangedText:"Password changed successfully",showPasswordChangedModal:!1,showFailureModal:!1,showLoader:!1}),methods:{requestPasswordChange:function(){this.showLoader=!0;const e=localStorage.getItem("token"),s=v()(e).username;m.a.post(`/users/${s}/change-password`,{oldPassword:this.oldPassword,newPassword:this.newPassword,newPasswordCheck:this.newPasswordCheck}).then(()=>{this.showPasswordChangedModal=!0}).catch(()=>{this.showFailureModal=!0}).finally(()=>this.showLoader=!1)}}},H=A,z=(t("555a"),Object(_["a"])(H,f,h,!1,null,"582d022b",null)),G=z.exports;const K=function(e){const s=JSON.parse(localStorage.getItem("permissions"));return s&&s[e]&&Array.isArray(s[e])?s[e]:[]};class Y{static canReadSettings(){return K("settings").includes("read")}static canUpdateSettings(){return K("settings").includes("update")}static canReadUsers(){return K("users").includes("read")}static canCreateUsers(){return K("users").includes("create")}static canDeleteUsers(){return K("users").includes("delete")}static canResetPassword(){return K("users").includes("resetPassword")}static canChangePermissions(){return K("users").includes("changePermissions")}}var Q={name:"NavBar",components:{PasswordChangeModal:G},props:{loggedIn:Boolean},data:()=>({displayChangePasswordModal:!1}),computed:{canViewPlatformConfig:()=>Y.canReadSettings(),canViewUsersManagement:()=>Y.canReadUsers()},methods:{logout:function(){m.a.post("/auth/logout",{}).finally(()=>{localStorage.removeItem("token"),localStorage.removeItem("permissions"),localStorage.removeItem("username"),localStorage.removeItem("serverUrl"),this.$emit("loggedOut"),this.$router.push("/login")})}}},W=Q,X=(t("87a2"),Object(_["a"])(W,c,u,!1,null,"e4856218",null)),Z=X.exports,ee={name:"App",components:{NavBar:Z},data:()=>({loggedIn:!1}),beforeMount(){this.loggedIn=!!localStorage.getItem("token"),this.loggedIn&&(m.a.defaults.baseURL=localStorage.getItem("serverUrl"),m.a.defaults.headers.common["authorization"]=localStorage.getItem("token"))}},se=ee,te=(t("034f"),Object(_["a"])(se,l,d,!1,null,null,null)),ae=te.exports,ne=t("8c4f"),oe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"home"})},re=[],ie={name:"Home",beforeMount(){localStorage.getItem("token")?Y.canReadSettings()?this.$router.push("/platform-config"):Y.canReadUsers()&&this.$router.push("/users-management"):this.$router.push("/login")}},le=ie,de=Object(_["a"])(le,oe,re,!1,null,null,null),ce=de.exports,ue=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"users-management"},[t("h2",[e._v("Users Management")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve users list from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),t("b-table",{attrs:{striped:"",hover:"","sticky-header":"43em",responsive:"",fixed:"",selectable:"","select-mode":"single","head-variant":"light",items:e.usersList,fields:e.tableHeaders,"primary-key":"username"},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(users)",fn:function(s){return[e._v(" "+e._s(s.item.username)+" ")]}},{key:"cell(permissions)",fn:function(s){return[t("PermissionsTable",{attrs:{username:s.item.username,permissions:s.item.permissions,disableCheckBoxes:!0},on:{permissionsTableClicked:e.onRowSelected}})]}}])}),t("b-card",[e.canCreate?t("b-button",{attrs:{variant:"success"},on:{click:function(s){e.showCreateUserModal=!0}}},[e._v(" Create ")]):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showEditUserModal?t("CreateEditUserModal",{attrs:{edit:!0,username:e.selectedUser.username,permissions:Object.assign({},e.selectedUser.permissions)},on:{close:function(s){e.showEditUserModal=!1},permissionsChanged:function(s){return e.onPermissionsChanged(s,e.selectedUser.username)},passwordResetDone:function(s){return e.onPasswordResetDone(s)},userDeleted:function(s){return e.onUserDeleted()}}}):e._e()],1),e.loadInProgress?t("loader",{attrs:{loading:e.loadInProgress}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showCreateUserModal?t("CreateEditUserModal",{attrs:{create:!0,permissions:{users:[],settings:[]}},on:{close:function(s){e.showCreateUserModal=!1},userCreated:function(s){return e.onUserCreated(s)}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPermissionsChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPermissionsChangedText},on:{close:function(s){return e.onUsersPermissionsChangedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPasswordResetedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPasswordResetedText},on:{close:function(s){return e.onUsersPasswordResetedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserDeletedModal?t("OperationSuccessfulModal",{attrs:{text:e.userDeletedText},on:{close:function(s){return e.onUserDeletedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserCreatedModal?t("OperationSuccessfulModal",{attrs:{text:e.userCreatedText},on:{close:function(s){return e.onUserCreatedModalClose()}}}):e._e()],1)],1)},pe=[],me=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"create-edit-user-modal"},[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.headerStart)+" user")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.saveChanges(s)}}},[t("b-form-group",{attrs:{label:"Username"}},[t("b-form-input",{attrs:{required:"",disabled:e.edit,type:"text",name:"username",id:"username",placeholder:"Username"},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),e.create?t("b-form-group",{attrs:{label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"password",id:"password",placeholder:"Password"},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1):e._e(),t("b-form-group",{attrs:{label:"Permissions"}},[t("br"),t("PermissionsTable",{attrs:{permissions:e.permissions,disableCheckBoxes:e.edit&&!e.canChangePermissions}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.edit?t("div",[t("hr"),e.canResetPassword?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showResetPasswordConfirmationModal=!0}}},[e._v(" Reset password ")]):e._e(),e.canDelete?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showDeleteConfirmationModal=!0}}},[e._v(" Delete ")]):e._e()],1):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showResetPasswordConfirmationModal?t("ConfirmationModal",{attrs:{text:e.resetPasswordConfirmationMsg},on:{close:function(s){e.showResetPasswordConfirmationModal=!1},confirm:function(s){return e.resetPassword()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showDeleteConfirmationModal?t("ConfirmationModal",{attrs:{text:e.deleteConfirmationMsg},on:{close:function(s){e.showDeleteConfirmationModal=!1},confirm:function(s){return e.deleteUser()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1)],1)},fe=[],he=t("4556"),ge=t.n(he),ve=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"permissions-table"},[t("table",{on:{click:function(s){return e.$emit("permissionsTableClicked",[{username:e.username,permissions:e.permissions}])}}},[e._m(0),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[e._v(" "+e._s(s)+" ")])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"settings-perm-"+s},[e._v(" "+e._s(s)+" ")])}))],2),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.users,expression:"permissions.users"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.users)?e._i(e.permissions.users,s)>-1:e.permissions.users},on:{change:function(t){var a=e.permissions.users,n=t.target,o=!!n.checked;if(Array.isArray(a)){var r=s,i=e._i(a,r);n.checked?i<0&&e.$set(e.permissions,"users",a.concat([r])):i>-1&&e.$set(e.permissions,"users",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"users",o)}}})])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"setttings-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.settings,expression:"permissions.settings"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.settings)?e._i(e.permissions.settings,s)>-1:e.permissions.settings},on:{change:function(t){var a=e.permissions.settings,n=t.target,o=!!n.checked;if(Array.isArray(a)){var r=s,i=e._i(a,r);n.checked?i<0&&e.$set(e.permissions,"settings",a.concat([r])):i>-1&&e.$set(e.permissions,"settings",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"settings",o)}}})])}))],2)])])},be=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("tr",[t("th",{attrs:{colspan:"5"}},[e._v("USERS")]),t("th",{attrs:{colspan:"2"}},[e._v("SETTINGS")])])}],we={name:"PermissionsTable",props:{username:String,permissions:{},disableCheckBoxes:Boolean},data:()=>({settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"]})},Ce=we,Pe=(t("2a9d"),Object(_["a"])(Ce,ve,be,!1,null,"0ee43795",null)),_e=Pe.exports,ye=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"confirmation-modal-mask"},[t("div",{staticClass:"confirmation-modal-wrapper"},[t("div",{staticClass:"confirmation-modal-container"},[t("div",{staticClass:"confirmation-modal-body"},[t("div",{staticClass:"confirmation-close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")]),t("div",{staticClass:"confirmation-text"},[e._v(e._s(e.text))])]),t("div",{staticClass:"confirmation-modal-footer"},[t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("confirm")}}},[e._v("Yes")]),t("br")],1)])])])},Me=[],ke={name:"ConfirmationModal",props:{text:String}},Ue=ke,xe=(t("63a0"),Object(_["a"])(Ue,ye,Me,!1,null,"b96c0804",null)),Se=xe.exports;const Oe=function(e,s){if(e&&e.response)return 401===e.response.status&&"Invalid token"===e.response.data.error.message&&(localStorage.removeItem("token"),s.$emit("loggedOut"),s.$router.push("/login"),!0)};var Re={name:"CreateEditUserModal",props:{edit:Boolean,create:Boolean,username:String,permissions:{}},components:{Modal:M,PermissionsTable:_e,ConfirmationModal:Se,Loader:B,OperationFailedModal:j},data:function(){return{password:"",showResetPasswordConfirmationModal:!1,showDeleteConfirmationModal:!1,resetPasswordConfirmationMsg:"Are you sure you want to reset the password of this user?",deleteConfirmationMsg:"Are you sure you want to delete this user?",showLoader:!1,showFailureModal:!1}},computed:{headerStart:function(){return this.edit?"Edit":"Create"},canChangePermissions:()=>Y.canChangePermissions(),canResetPassword:()=>Y.canResetPassword(),canDelete:()=>Y.canDeleteUsers()},methods:{saveChanges:function(){this.create?this.createUser():this.edit&&this.changePermissions()},createUser(){this.showLoader=!0,m.a.post("/users",{username:this.username,password:this.password,permissions:this.permissions}).then(()=>{this.$emit("userCreated",{username:this.username,password:this.password})}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},changePermissions(){this.showLoader=!0,m.a.put(`/users/${this.username}/permissions`,{permissions:this.permissions}).then(()=>{this.$emit("permissionsChanged",this.permissions)}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},resetPassword(){this.showResetPasswordConfirmationModal=!1,this.showLoader=!0,m.a.post(`/users/${this.username}/reset-password`,{}).then(e=>{this.$emit("passwordResetDone",e.data)}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},deleteUser(){this.showDeleteConfirmationModal=!1,this.showLoader=!0,m.a.delete("/users/"+this.username).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).then(()=>{this.$emit("userDeleted")}).finally(()=>this.showLoader=!1)}},beforeMount(){this.password=ge()({length:10,type:"url-safe"})}},Ie=Re,$e=(t("5643"),Object(_["a"])(Ie,me,fe,!1,null,"64fb18e0",null)),Fe=$e.exports,Ee={name:"UsersManagement",components:{Loader:B,CreateEditUserModal:Fe,PermissionsTable:_e,OperationSuccessfulModal:R},data:()=>({usersList:[],loadFailed:!1,loadInProgress:!1,selectedUser:{},tableHeaders:[{key:"users",label:"Username",thStyle:{"text-align":"center"},class:"users-management-user-row"},{key:"permissions",label:"Permissions",thStyle:{"text-align":"center"}}],settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"],showCreateUserModal:!1,showEditUserModal:!1,showUserDeletedModal:!1,userDeletedText:"User deleted successfully",showUserCreatedModal:!1,userCreatedInitialText:"User created successfully.",userCreatedText:"",showUsersPasswordResetedModal:!1,usersPasswordResetedInitialText:"User's password reset successful.",usersPasswordResetedText:"",showUsersPermissionsChangedModal:!1,usersPermissionsChangedText:"User's permissions updated successfully"}),computed:{canChangePermissions:()=>Y.canChangePermissions(),canCreate:()=>Y.canCreateUsers()},methods:{onUsersPermissionsChangedModalClose:function(){this.showUsersPermissionsChangedModal=!1,this.showEditUserModal=!1},onUsersPasswordResetedModalClose:function(){this.showUsersPasswordResetedModal=!1,this.showEditUserModal=!1},onUserDeletedModalClose:function(){this.showUserDeletedModal=!1,this.showEditUserModal=!1},onUserCreatedModalClose:function(){this.showUserCreatedModal=!1,this.showCreateUserModal=!1},onPasswordResetDone:function(e){this.usersPasswordResetedText=`${this.usersPasswordResetedInitialText} New password: ${e.password}`,this.showUsersPasswordResetedModal=!0},onRowSelected:function(e){e&&e.length>0?(this.selectedUser=e[0],this.canChangePermissions&&(this.showEditUserModal=!0)):this.selectedUser=""},onUserCreated:function(e){this.userCreatedText=`${this.userCreatedInitialText} username: ${e.username} \n password: ${e.password}`,this.showUserCreatedModal=!0,this.getUsersList()},onUserDeleted:function(){this.showUserDeletedModal=!0,this.getUsersList()},onPermissionsChanged:function(e,s){this.showUsersPermissionsChangedModal=!0,this.usersList.find(e=>e.username===s).permissions=e},getUsersList:function(){this.loadInProgress=!0,m.a.get("/users").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;this.usersList=e.data}).catch(e=>{Oe(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})}},beforeMount(){this.getUsersList()}},Te=Ee,je=(t("8ab9"),Object(_["a"])(Te,ue,pe,!1,null,"7d12ca92",null)),Le=je.exports,De=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"platform-config"},[t("h2",[e._v("Platform Configuration")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve configuration from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),e.updateInProgress||e.loadInProgress?t("loader",{attrs:{loading:e.updateInProgress}}):e._e(),e.updateFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to update configuration.")]),t("p",[e._v("Verify provided information or try again later.")])])]):e._e(),t("br"),t("b-card",{attrs:{"no-body":""}},[0!==Object.keys(e.config).length?t("b-tabs",{attrs:{pills:"",justified:"",card:""},model:{value:e.activeTabIndex,callback:function(s){e.activeTabIndex=s},expression:"activeTabIndex"}},e._l(e.config,(function(s,a){return t("b-tab",{key:a,attrs:{"title-link-class":"tab-title",title:s.name}},[t("ConfigTable",{attrs:{initialConfigSection:a},on:{invalidJson:function(s){e.inputValid=!1},validJson:function(s){e.inputValid=!0}}})],1)})),1):e._e()],1),0!==Object.keys(e.config).length&&e.canUpdateSettings?t("b-card",[t("b-button",{attrs:{variant:"success",disabled:!e.inputValid},on:{click:e.updateConfig}},[e._v("Update")])],1):e._e(),t("transition",{attrs:{name:"modal"}},[e.showModal?t("UpdateReportModal",{attrs:{updateReport:e.updateConfigReport},on:{updateReportModalClosed:function(s){e.showModal=!1}}}):e._e()],1)],1)},Ne=[],Ve=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"config-table"},[t("b-table",{attrs:{striped:"",hover:"","sticky-header":"36em",responsive:"",fixed:"","head-variant":"light",items:e.displayConfig,fields:e.tableHeaders},scopedSlots:e._u([{key:"cell(property)",fn:function(s){return[t("div",{staticClass:"tab-cell"},[e._v(e._s(s.item.property))])]}},{key:"cell(value)",fn:function(s){return["object"!==typeof s.item.value?t("div",[(""+s.item.value).length>70?t("b-form-textarea",{attrs:{size:"sm","max-rows":"6","no-resize":"",disabled:!e.canUpdateSettings||e.isPropertyReadOnly(s.item.property)},on:{blur:function(t){return e.onValueChanged(t.target.value,s.item.property)}},model:{value:s.item.value,callback:function(t){e.$set(s.item,"value",t)},expression:"row.item.value"}}):t("b-form-input",{attrs:{disabled:!e.canUpdateSettings||e.isPropertyReadOnly(s.item.property)},on:{blur:function(t){return e.onValueChanged(t.target.value,s.item.property)}},model:{value:s.item.value,callback:function(t){e.$set(s.item,"value",t)},expression:"row.item.value"}})],1):e._e(),"object"===typeof s.item.value?t("VJsoneditor",{staticClass:"editor",attrs:{plus:!1,options:{onValidationError:function(s){e.onValidationError(s)},onChangeText:function(t){e.onChangedJsonText(t,s.item.property)},enableTransform:!1,enableSort:!1,statusBar:!1,mainMenuBar:!0,search:!1,navigationBar:!1,mode:"code",onEditable:e.forbidCertainEditions}},model:{value:s.item.value,callback:function(t){e.$set(s.item,"value",t)},expression:"row.item.value"}}):e._e()]}},{key:"cell(description)",fn:function(s){return[t("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"tab-cell",domProps:{innerHTML:e._s(s.item.description)}})]}}])})],1)},Je=[],qe=a["default"].observable({state:{config:{}}}),Be=t("bcb2"),Ae=t.n(Be),He={name:"ConfigTable",props:{initialConfigSection:String},components:{VJsoneditor:Ae.a},data:function(){return{configSection:this.initialConfigSection,tableHeaders:[{key:"property",label:"Property",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"},{key:"value",label:"Value",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"},{key:"description",label:"Description",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"}]}},computed:{canUpdateSettings:()=>Y.canUpdateSettings(),config:function(){return qe.state.config[this.configSection].settings},displayConfig:function(){return Object.keys(this.config).map(function(e){const s=this.config[e].description?this.config[e].description:null;let t=this.config[e];return Object.prototype.hasOwnProperty.call(t,"value")&&(t=t.value),t||"boolean"===typeof t?"boolean"===typeof t?t=String(t):this.isJSON(t)&&(t=JSON.parse(t)):t="",{property:e,value:t,description:s}}.bind(this))}},methods:{isPropertyReadOnly:function(e){return"TEMPLATE_VERSION"===e},forbidCertainEditions:function(e){return!!this.canUpdateSettings&&("description"!==e.field&&(!e.field||{field:!1,value:!0}))},onValueChanged:function(e,s){this.isJSON(e)&&(e=JSON.parse(e)),this.config[s].value=e},onChangedJsonText:function(e,s){(this.isJSON(e)||"object"===typeof e)&&(this.config[s].value=JSON.parse(e),this.$emit("validJson"))},onValidationError:function(e){e&&e.length>0&&this.$emit("invalidJson")},isJSON:function(e){try{JSON.parse(e)}catch(s){return!1}return!0}}},ze=He,Ge=(t("dd6c"),Object(_["a"])(ze,Ve,Je,!1,null,"45a4c1dc",null)),Ke=Ge.exports,Ye=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("Modal",{on:{close:function(s){return e.$emit("updateReportModalClosed")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Update report")]),t("div",{attrs:{slot:"body"},slot:"body"},[Object.keys(e.updateReport.successes).length>0?t("div",[t("h4",[e._v("Successes")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.successes}})],1):e._e(),Object.keys(e.updateReport.failures).length>0?t("div",[t("h4",[e._v("Failures")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.failures}})],1):e._e()])])},Qe=[],We={name:"UpdateReportModal",components:{Modal:M},props:{updateReport:{}},computed:{successes:function(){return Object.keys(this.updateReport.successes).map(function(e){return{url:this.updateReport.successes[e].url,role:this.updateReport.successes[e].role}}.bind(this))},failures:function(){return Object.keys(this.updateReport.failures).map(function(e){return{url:this.updateReport.failures[e].url,role:this.updateReport.failures[e].role,error:this.updateReport.failures[e].error}}.bind(this))}}},Xe=We,Ze=(t("ace3"),Object(_["a"])(Xe,Ye,Qe,!1,null,"24cc2062",null)),es=Ze.exports,ss={name:"Config",components:{ConfigTable:Ke,UpdateReportModal:es,Loader:B},data:()=>({loadFailed:!1,updateFailed:!1,showModal:!1,updateConfigReport:{},updateInProgress:!1,loadInProgress:!1,inputValid:!0}),computed:{config:()=>qe.state.config,canUpdateSettings:()=>Y.canUpdateSettings(),activeTabIndex:{get:function(){return Object.keys(qe.state.config).findIndex(e=>"SERVICE_INFORMATION_SETTINGS"===e)},set:function(){}}},methods:{getConfig:function(){qe.state.config={},this.loadInProgress=!0,m.a.get("/admin/settings").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;qe.state.config=e.data}).catch(e=>{Oe(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})},updateConfig:function(){this.updateInProgress=!0,this.updateFailed=!1,m.a.put("/admin/settings",qe.state.config).then(()=>m.a.post("/admin/notify",{})).then(e=>{if(!e.data||!Object.hasOwnProperty.call(e.data,"successes")||!Object.hasOwnProperty.call(e.data,"failures"))throw new Error;this.updateConfigReport=e.data,this.showModal=!0}).catch(()=>{this.updateFailed=!0}).finally(()=>{this.updateInProgress=!1})},resetFailureIndicators:function(){this.loadFailed=!1,this.updateFailed=!1}},beforeMount(){this.getConfig()}},ts=ss,as=(t("7214"),Object(_["a"])(ts,De,Ne,!1,null,"b2c2b7a0",null)),ns=as.exports,os=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"login"},[t("h1",[e._v("Administration Panel")]),t("h3",[e._v("Please log in")]),t("b-card",[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.login(s)}}},[t("b-form-group",{attrs:{"label-for":"serverUrl",label:"Config leader address"}},[t("b-form-input",{attrs:{required:"",pattern:"https?://\\S+",type:"text",name:"serverUrl",id:"serverUrl",placeholder:"https://lead.platform.com"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.serverUrl,callback:function(s){e.serverUrl=s},expression:"serverUrl"}})],1),t("b-form-group",{attrs:{"label-for":"username",label:"Username"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"username",id:"username",placeholder:"Username"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),t("b-form-group",{attrs:{"label-for":"password",label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Password"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1),t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v("Login")])],1)],1),e.loginFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[e.loginRequestFailed?e._e():t("p",[e._v(" Incorrect credentials. Please verify your input ")]),e.loginRequestFailed?t("p",[e._v(" Unable to connect to the server. Please try again later ")]):e._e()])]):e._e(),e.loginInProgress?t("loader",{attrs:{loading:e.loginInProgress}}):e._e()],1)},rs=[],is={name:"Login",components:{Loader:B},data:()=>({serverUrl:"",username:"",password:"",loginFailed:!1,loginRequestFailed:!1,loginInProgress:!1}),methods:{login:function(){this.loginInProgress=!0,m.a.post(this.serverUrl+"/auth/login",{username:this.username,password:this.password}).then(e=>{if(!e.data||0===Object.keys(e.data).length||!e.data.token)throw new Error;localStorage.setItem("serverUrl",this.serverUrl),localStorage.setItem("token",e.data.token);const s=v()(e.data.token);localStorage.setItem("permissions",JSON.stringify(s.permissions)),localStorage.setItem("username",s.username),m.a.defaults.baseURL=this.serverUrl,m.a.defaults.headers.common["authorization"]=e.data.token,this.$emit("loggedIn"),this.$router.push("/")}).catch(e=>{(e&&e.response&&e.response.status&&e.response.status>=500||"Network Error"===e.message)&&(this.loginRequestFailed=!0),this.loginFailed=!0}).finally(()=>{this.loginInProgress=!1})}}},ls=is,ds=(t("ddea"),Object(_["a"])(ls,os,rs,!1,null,"827aa444",null)),cs=ds.exports;a["default"].use(ne["a"]);const us=[{path:"/",name:"Home",component:ce},{path:"/login",name:"Login",component:cs},{path:"/users-management",name:"UsersManagement",component:Le},{path:"/platform-config",name:"Config",component:ns}],ps=new ne["a"]({routes:us});var ms=ps;a["default"].config.productionTip=!1,new a["default"]({router:ms,render:e=>e(ae)}).$mount("#app")},6:function(e,s){},"63a0":function(e,s,t){"use strict";var a=t("c8da"),n=t.n(a);n.a},"697e":function(e,s,t){},7:function(e,s){},7214:function(e,s,t){"use strict";var a=t("697e"),n=t.n(a);n.a},"75c5":function(e,s,t){},8:function(e,s){},"85ec":function(e,s,t){},"87a2":function(e,s,t){"use strict";var a=t("12cf"),n=t.n(a);n.a},"8ab9":function(e,s,t){"use strict";var a=t("95ae"),n=t.n(a);n.a},9:function(e,s){},"95ae":function(e,s,t){},"9da0":function(e,s,t){},ace3:function(e,s,t){"use strict";var a=t("018c"),n=t.n(a);n.a},b24f:function(e,s,t){"use strict";var a=t("fced"),n=t.n(a);n.a},c8da:function(e,s,t){},cf05:function(e,s,t){e.exports=t.p+"img/logo.54cacaa3.png"},d609:function(e,s,t){"use strict";var a=t("9da0"),n=t.n(a);n.a},dd6c:function(e,s,t){"use strict";var a=t("5534"),n=t.n(a);n.a},ddea:function(e,s,t){"use strict";var a=t("400e"),n=t.n(a);n.a},df64:function(e,s,t){"use strict";var a=t("058e"),n=t.n(a);n.a},fced:function(e,s,t){}});
//# sourceMappingURL=app.c2c0ee58.js.map