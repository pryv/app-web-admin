(function(e){function s(s){for(var a,n,i=s[0],l=s[1],d=s[2],u=0,f=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&f.push(r[n][0]),r[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(s);while(f.length)f.shift()();return o.push.apply(o,d||[]),t()}function t(){for(var e,s=0;s<o.length;s++){for(var t=o[s],a=!0,i=1;i<t.length;i++){var l=t[i];0!==r[l]&&(a=!1)}a&&(o.splice(s--,1),e=n(n.s=t[0]))}return e}var a={},r={app:0},o=[];function n(s){if(a[s])return a[s].exports;var t=a[s]={i:s,l:!1,exports:{}};return e[s].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=a,n.d=function(e,s,t){n.o(e,s)||Object.defineProperty(e,s,{enumerable:!0,get:t})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,s){if(1&s&&(e=n(e)),8&s)return e;if(4&s&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&s&&"string"!=typeof e)for(var a in e)n.d(t,a,function(s){return e[s]}.bind(null,a));return t},n.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(s,"a",s),s},n.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},n.p="/app-web-admin/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=s,i=i.slice();for(var d=0;d<i.length;d++)s(i[d]);var c=l;o.push([0,"chunk-vendors"]),t()})({0:function(e,s,t){e.exports=t("56d7")},"018c":function(e,s,t){},"034f":function(e,s,t){"use strict";var a=t("85ec"),r=t.n(a);r.a},"04e0":function(e,s,t){},"058e":function(e,s,t){},1:function(e,s){},"13fd":function(e,s,t){"use strict";var a=t("3a9d"),r=t.n(a);r.a},2:function(e,s){},2527:function(e,s,t){"use strict";var a=t("04e0"),r=t.n(a);r.a},"2a9d":function(e,s,t){"use strict";var a=t("4d15"),r=t.n(a);r.a},"2bc4":function(e,s,t){},3:function(e,s){},"3a9d":function(e,s,t){},"3f3b":function(e,s,t){"use strict";var a=t("7c31"),r=t.n(a);r.a},4:function(e,s){},"4d15":function(e,s,t){},5:function(e,s){},"56d7":function(e,s,t){"use strict";t.r(s);var a=t("2b0e"),r=t("5f5b"),o=t("b1e0");t("ab8b"),t("2dd8");a["default"].use(r["a"]),a["default"].use(o["a"]);var n=t("9aa5"),i=t.n(n);a["default"].directive("linkified",i.a);var l=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"app"}},[t("NavBar",{attrs:{loggedIn:e.loggedIn},on:{loggedOut:function(s){e.loggedIn=!1}}}),t("router-view",{on:{loggedIn:function(s){e.loggedIn=!0},loggedOut:function(s){e.loggedIn=!1}}})],1)},d=[],c=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",[a("b-navbar",{attrs:{toggleable:"md",type:"light",variant:"info",fixed:"top"}},[a("b-navbar-brand",{attrs:{href:"https://api.pryv.com"}},[a("img",{attrs:{alt:"Logo",src:t("cf05")}})]),e.loggedIn?a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}):e._e(),e.loggedIn?a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{staticClass:"ml-auto",attrs:{tag:"div"}},[e.canViewPlatformConfig?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/platform-config"}},[e._v("Platform Configuration")]):e._e(),e.canViewUsersManagement?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/users-management"}},[e._v("Users Management")]):e._e()],1),a("b-navbar-nav",{attrs:{align:"right",tag:"div"}},[a("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("em",[e._v("Profile")])]},proxy:!0}],null,!1,2313340923)},[a("b-dropdown-item",{on:{click:function(s){e.displayChangePasswordModal=!0}}},[e._v("Change Password")]),a("b-dropdown-item",{on:{click:function(s){return e.logout()}}},[e._v("Sign Out")])],1)],1)],1):e._e()],1),a("transition",{attrs:{name:"modal"}},[e.displayChangePasswordModal?a("PasswordChangeModal",{on:{close:function(s){e.displayChangePasswordModal=!1}}}):e._e()],1)],1)},u=[],f=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Enter new password")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.requestPasswordChange(s)}}},[t("b-form-group",{attrs:{"label-for":"oldPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"oldPassword",id:"oldPassword",placeholder:"Old Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.oldPassword,callback:function(s){e.oldPassword=s},expression:"oldPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPassword"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPassword",id:"newPassword",placeholder:"New Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPassword,callback:function(s){e.newPassword=s},expression:"newPassword"}})],1),t("b-form-group",{attrs:{"label-for":"newPasswordCheck"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"newPasswordCheck",id:"newPasswordCheck",placeholder:"Confirm Password"},on:{input:function(s){e.passwordChangeFailed=!1}},model:{value:e.newPasswordCheck,callback:function(s){e.newPasswordCheck=s},expression:"newPasswordCheck"}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.passwordChangeFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Password change failed")]),t("p",[e._v("Please try again later")])])]):e._e(),e.passwordChangeSuccessful?t("b-card",[t("div",{staticClass:"success-msg"},[t("p",[e._v("Password successfully changed")])])]):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showPasswordChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.passwordChangedText},on:{close:function(s){return e.$emit("close")}}}):e._e()],1),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e()],1)},p=[],m=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"modal-mask"},[t("div",{staticClass:"modal-wrapper"},[t("div",{staticClass:"modal-container"},[t("div",{staticClass:"modal-header"},[e._t("header",[e._v(e._s(e.header))]),t("div",{staticClass:"close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")])],2),t("div",{staticClass:"modal-body"},[e._t("body",[e._v(e._s(e.body))])],2),t("div",{staticClass:"modal-footer"},[e._t("footer",[e.showCancelButton?t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]):e._e(),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("close")}}},[e._v("OK")]),t("br")])],2)])])])},h=[],g={name:"Modal",props:{header:String,body:String,showCancelButton:Boolean}},v=g,b=(t("2527"),t("2877")),w=Object(b["a"])(v,m,h,!1,null,"75ef802d",null),C=w.exports,P=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-successful-modal-mask"},[t("div",{staticClass:"operation-successful-modal-wrapper"},[t("div",{staticClass:"operation-successful-modal-container"},[t("div",{staticClass:"operation-successful-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"success"}}),t("b-icon",{attrs:{stacked:"",icon:"check",variant:"success"}})],1),t("div",{staticClass:"operation-successful-modal-message"},[e._v(e._s(e.text))]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Close ")])],1)])])])},_=[],y={name:"OperationSuccessfulModal",props:{text:String}},M=y,k=(t("df64"),Object(b["a"])(M,P,_,!1,null,"0f12b945",null)),U=k.exports,x=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"operation-failed-modal-mask"},[t("div",{staticClass:"operation-failed-modal-wrapper",on:{click:function(s){return e.$emit("close")}}},[t("div",{staticClass:"operation-failed-modal-container"},[t("div",{staticClass:"operation-failed-modal-body"},[t("b-iconstack",{attrs:{"font-scale":"10"}},[t("b-icon",{attrs:{stacked:"",icon:"circle",variant:"danger"}}),t("b-icon",{attrs:{stacked:"",icon:"x",variant:"danger"}})],1),t("div",{staticClass:"operation-failed-modal-message"},[e._v(" Failed to process the request. Verify your input or try again later ")])],1)])])])},S=[],O={name:"OperationFailedModal"},R=O,$=(t("b24f"),Object(b["a"])(R,x,S,!1,null,"e9f76e9c",null)),I=$.exports,F=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"loader-mask"},[t("div",{staticClass:"loader-wrapper"},[t("pulse-loader")],1)])},E=[],j=t("8a5d"),L={name:"Loader",components:{PulseLoader:j["a"]}},T=L,D=(t("d609"),Object(b["a"])(T,F,E,!1,null,"97a2206a",null)),q=D.exports;const N=t("bc3a"),B=t("04e1");var A={name:"PasswordChangeModal",components:{Modal:C,OperationSuccessfulModal:U,OperationFailedModal:I,Loader:q},data:()=>({oldPassword:"",newPassword:"",newPasswordCheck:"",passwordChangeFailed:!1,passwordChangeSuccessful:!1,passwordProvided:!0,passwordChangedText:"Password changed successfully",showPasswordChangedModal:!1,showFailureModal:!1,showLoader:!1}),methods:{requestPasswordChange:function(){this.showLoader=!0;const e=localStorage.getItem("token"),s=B(e).username;N.post(`/users/${s}/change-password`,{oldPassword:this.oldPassword,newPassword:this.newPassword,newPasswordCheck:this.newPasswordCheck}).then(()=>{this.showPasswordChangedModal=!0}).catch(()=>{this.showFailureModal=!0}).finally(()=>this.showLoader=!1)}}},V=A,H=(t("13fd"),Object(b["a"])(V,f,p,!1,null,"683d2546",null)),J=H.exports;const z=function(e){const s=JSON.parse(localStorage.getItem("permissions"));return s&&s[e]&&Array.isArray(s[e])?s[e]:[]};class G{static canReadSettings(){return z("settings").includes("read")}static canUpdateSettings(){return z("settings").includes("update")}static canReadUsers(){return z("users").includes("read")}static canCreateUsers(){return z("users").includes("create")}static canDeleteUsers(){return z("users").includes("delete")}static canResetPassword(){return z("users").includes("resetPassword")}static canChangePermissions(){return z("users").includes("changePermissions")}}const K=t("bc3a");var Y={name:"NavBar",components:{PasswordChangeModal:J},props:{loggedIn:Boolean},data:()=>({displayChangePasswordModal:!1}),computed:{canViewPlatformConfig:()=>G.canReadSettings(),canViewUsersManagement:()=>G.canReadUsers()},methods:{logout:function(){K.post("/auth/logout",{}).finally(()=>{localStorage.removeItem("token"),localStorage.removeItem("permissions"),localStorage.removeItem("username"),localStorage.removeItem("serverUrl"),this.$emit("loggedOut"),this.$router.push("/login")})}}},Q=Y,W=(t("d86b"),Object(b["a"])(Q,c,u,!1,null,"dd9de8cc",null)),X=W.exports;const Z=t("bc3a");var ee={name:"App",components:{NavBar:X},data:()=>({loggedIn:!1}),beforeMount(){this.loggedIn=!!localStorage.getItem("token"),this.loggedIn&&(Z.defaults.baseURL=localStorage.getItem("serverUrl"),Z.defaults.headers.common["authorization"]=localStorage.getItem("token"))}},se=ee,te=(t("034f"),Object(b["a"])(se,l,d,!1,null,null,null)),ae=te.exports,re=t("8c4f"),oe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"home"})},ne=[],ie={name:"Home",beforeMount(){localStorage.getItem("token")?G.canReadSettings()?this.$router.push("/platform-config"):G.canReadUsers()&&this.$router.push("/users-management"):this.$router.push("/login")}},le=ie,de=Object(b["a"])(le,oe,ne,!1,null,null,null),ce=de.exports,ue=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"users-management"},[t("h2",[e._v("Users Management")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve users list from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),t("b-table",{attrs:{striped:"",hover:"","sticky-header":"49em",responsive:"",fixed:"",selectable:"","select-mode":"single","head-variant":"light",items:e.usersList,fields:e.tableHeaders,"primary-key":"username"},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(users)",fn:function(s){return[e._v(" "+e._s(s.item.username)+" ")]}},{key:"cell(permissions)",fn:function(s){return[t("PermissionsTable",{attrs:{username:s.item.username,permissions:s.item.permissions,disableCheckBoxes:!0},on:{permissionsTableClicked:e.onRowSelected}})]}}])}),t("b-card",[e.canCreate?t("b-button",{attrs:{variant:"success"},on:{click:function(s){e.showCreateUserModal=!0}}},[e._v(" Create ")]):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showEditUserModal?t("CreateEditUserModal",{attrs:{edit:!0,username:e.selectedUser.username,permissions:Object.assign({},e.selectedUser.permissions)},on:{close:function(s){e.showEditUserModal=!1},permissionsChanged:function(s){return e.onPermissionsChanged(s,e.selectedUser.username)},passwordResetDone:function(s){return e.onPasswordResetDone(s)},userDeleted:function(s){return e.onUserDeleted()}}}):e._e()],1),e.loadInProgress?t("loader",{attrs:{loading:e.loadInProgress}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showCreateUserModal?t("CreateEditUserModal",{attrs:{create:!0,permissions:{users:[],settings:[]}},on:{close:function(s){e.showCreateUserModal=!1},userCreated:function(s){return e.onUserCreated(s)}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPermissionsChangedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPermissionsChangedText},on:{close:function(s){return e.onUsersPermissionsChangedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUsersPasswordResetedModal?t("OperationSuccessfulModal",{attrs:{text:e.usersPasswordResetedText},on:{close:function(s){return e.onUsersPasswordResetedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserDeletedModal?t("OperationSuccessfulModal",{attrs:{text:e.userDeletedText},on:{close:function(s){return e.onUserDeletedModalClose()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showUserCreatedModal?t("OperationSuccessfulModal",{attrs:{text:e.userCreatedText},on:{close:function(s){return e.onUserCreatedModalClose()}}}):e._e()],1)],1)},fe=[],pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"create-edit-user-modal"},[t("Modal",{on:{close:function(s){return e.$emit("close")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.headerStart)+" user")]),t("div",{attrs:{slot:"body"},slot:"body"},[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.saveChanges(s)}}},[t("b-form-group",{attrs:{label:"Username"}},[t("b-form-input",{attrs:{required:"",disabled:e.edit,type:"text",name:"username",id:"username",placeholder:"Username"},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),e.create?t("b-form-group",{attrs:{label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"password",id:"password",placeholder:"Password"},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1):e._e(),t("b-form-group",{attrs:{label:"Permissions"}},[t("br"),t("PermissionsTable",{attrs:{permissions:e.permissions,disableCheckBoxes:e.edit&&!e.canChangePermissions}})],1),t("div",{staticClass:"modal-footer"},[t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v(" Save ")]),t("b-button",{attrs:{variant:"secondary"},on:{click:function(s){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.edit?t("div",[t("hr"),e.canResetPassword?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showResetPasswordConfirmationModal=!0}}},[e._v(" Reset password ")]):e._e(),e.canDelete?t("b-button",{staticClass:"btn-sm black-button",attrs:{variant:"dark"},on:{click:function(s){e.showDeleteConfirmationModal=!0}}},[e._v(" Delete ")]):e._e()],1):e._e()],1),t("div",{attrs:{slot:"footer"},slot:"footer"})]),e.showLoader?t("loader",{attrs:{loading:e.showLoader}}):e._e(),t("transition",{attrs:{name:"modal"}},[e.showResetPasswordConfirmationModal?t("ConfirmationModal",{attrs:{text:e.resetPasswordConfirmationMsg},on:{close:function(s){e.showResetPasswordConfirmationModal=!1},confirm:function(s){return e.resetPassword()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showDeleteConfirmationModal?t("ConfirmationModal",{attrs:{text:e.deleteConfirmationMsg},on:{close:function(s){e.showDeleteConfirmationModal=!1},confirm:function(s){return e.deleteUser()}}}):e._e()],1),t("transition",{attrs:{name:"modal"}},[e.showFailureModal?t("OperationFailedModal",{on:{close:function(s){e.showFailureModal=!1}}}):e._e()],1)],1)},me=[],he=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"permissions-table"},[t("table",{on:{click:function(s){return e.$emit("permissionsTableClicked",[{username:e.username,permissions:e.permissions}])}}},[e._m(0),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[e._v(" "+e._s(s)+" ")])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"settings-perm-"+s},[e._v(" "+e._s(s)+" ")])}))],2),t("tr",[e._l(e.usersPermissions,(function(s){return t("td",{key:"users-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.users,expression:"permissions.users"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.users)?e._i(e.permissions.users,s)>-1:e.permissions.users},on:{change:function(t){var a=e.permissions.users,r=t.target,o=!!r.checked;if(Array.isArray(a)){var n=s,i=e._i(a,n);r.checked?i<0&&e.$set(e.permissions,"users",a.concat([n])):i>-1&&e.$set(e.permissions,"users",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"users",o)}}})])})),e._l(e.settingsPermissions,(function(s){return t("td",{key:"setttings-perm-"+s},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.settings,expression:"permissions.settings"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:s,checked:Array.isArray(e.permissions.settings)?e._i(e.permissions.settings,s)>-1:e.permissions.settings},on:{change:function(t){var a=e.permissions.settings,r=t.target,o=!!r.checked;if(Array.isArray(a)){var n=s,i=e._i(a,n);r.checked?i<0&&e.$set(e.permissions,"settings",a.concat([n])):i>-1&&e.$set(e.permissions,"settings",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"settings",o)}}})])}))],2)])])},ge=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("tr",[t("th",{attrs:{colspan:"5"}},[e._v("USERS")]),t("th",{attrs:{colspan:"2"}},[e._v("SETTINGS")])])}],ve={name:"PermissionsTable",props:{username:String,permissions:{},disableCheckBoxes:Boolean},data:()=>({settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"]})},be=ve,we=(t("2a9d"),Object(b["a"])(be,he,ge,!1,null,"0ee43795",null)),Ce=we.exports,Pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"confirmation-modal-mask"},[t("div",{staticClass:"confirmation-modal-wrapper"},[t("div",{staticClass:"confirmation-modal-container"},[t("div",{staticClass:"confirmation-modal-body"},[t("div",{staticClass:"confirmation-close-button",on:{click:function(s){return e.$emit("close")}}},[e._v("x")]),t("div",{staticClass:"confirmation-text"},[e._v(e._s(e.text))])]),t("div",{staticClass:"confirmation-modal-footer"},[t("b-button",{attrs:{variant:"danger"},on:{click:function(s){return e.$emit("close")}}},[e._v("Cancel")]),t("b-button",{attrs:{variant:"success"},on:{click:function(s){return e.$emit("confirm")}}},[e._v("Yes")]),t("br")],1)])])])},_e=[],ye={name:"ConfirmationModal",props:{text:String}},Me=ye,ke=(t("63a0"),Object(b["a"])(Me,Pe,_e,!1,null,"b96c0804",null)),Ue=ke.exports;const xe=t("4556"),Se=t("bc3a"),{handleHttpErrors:Oe}=t("dc5b");var Re={name:"CreateEditUserModal",props:{edit:Boolean,create:Boolean,username:String,permissions:{}},components:{Modal:C,PermissionsTable:Ce,ConfirmationModal:Ue,Loader:q,OperationFailedModal:I},data:function(){return{password:"",showResetPasswordConfirmationModal:!1,showDeleteConfirmationModal:!1,resetPasswordConfirmationMsg:"Are you sure you want to reset the password of this user?",deleteConfirmationMsg:"Are you sure you want to delete this user?",showLoader:!1,showFailureModal:!1}},computed:{headerStart:function(){return this.edit?"Edit":"Create"},canChangePermissions:()=>G.canChangePermissions(),canResetPassword:()=>G.canResetPassword(),canDelete:()=>G.canDeleteUsers()},methods:{saveChanges:function(){this.create?this.createUser():this.edit&&this.changePermissions()},createUser(){this.showLoader=!0,Se.post("/users",{username:this.username,password:this.password,permissions:this.permissions}).then(()=>{this.$emit("userCreated",{username:this.username,password:this.password})}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},changePermissions(){this.showLoader=!0,Se.put(`/users/${this.username}/permissions`,{permissions:this.permissions}).then(()=>{this.$emit("permissionsChanged",this.permissions)}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},resetPassword(){this.showResetPasswordConfirmationModal=!1,this.showLoader=!0,Se.post(`/users/${this.username}/reset-password`,{}).then(e=>{this.$emit("passwordResetDone",e.data)}).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},deleteUser(){this.showDeleteConfirmationModal=!1,this.showLoader=!0,Se.delete("/users/"+this.username).catch(e=>{Oe(e,this)||(this.showFailureModal=!0)}).then(()=>{this.$emit("userDeleted")}).finally(()=>this.showLoader=!1)}},beforeMount(){this.password=xe({length:10,type:"url-safe"})}},$e=Re,Ie=(t("5fc0"),Object(b["a"])($e,pe,me,!1,null,"af559112",null)),Fe=Ie.exports;const Ee=t("bc3a"),{handleHttpErrors:je}=t("dc5b");var Le={name:"UsersManagement",components:{Loader:q,CreateEditUserModal:Fe,PermissionsTable:Ce,OperationSuccessfulModal:U},data:()=>({usersList:[],loadFailed:!1,loadInProgress:!1,selectedUser:{},tableHeaders:[{key:"users",label:"Username",thStyle:{"text-align":"center"},class:"users-management-user-row"},{key:"permissions",label:"Permissions",thStyle:{"text-align":"center"}}],settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"],showCreateUserModal:!1,showEditUserModal:!1,showUserDeletedModal:!1,userDeletedText:"User deleted successfully",showUserCreatedModal:!1,userCreatedInitialText:"User created successfully.",userCreatedText:"",showUsersPasswordResetedModal:!1,usersPasswordResetedInitialText:"User's password reset successful.",usersPasswordResetedText:"",showUsersPermissionsChangedModal:!1,usersPermissionsChangedText:"User's permissions updated successfully"}),computed:{canChangePermissions:()=>G.canChangePermissions(),canCreate:()=>G.canCreateUsers()},methods:{onUsersPermissionsChangedModalClose:function(){this.showUsersPermissionsChangedModal=!1,this.showEditUserModal=!1},onUsersPasswordResetedModalClose:function(){this.showUsersPasswordResetedModal=!1,this.showEditUserModal=!1},onUserDeletedModalClose:function(){this.showUserDeletedModal=!1,this.showEditUserModal=!1},onUserCreatedModalClose:function(){this.showUserCreatedModal=!1,this.showCreateUserModal=!1},onPasswordResetDone:function(e){this.usersPasswordResetedText=`${this.usersPasswordResetedInitialText} New password: ${e.password}`,this.showUsersPasswordResetedModal=!0},onRowSelected:function(e){e&&e.length>0?(this.selectedUser=e[0],this.canChangePermissions&&(this.showEditUserModal=!0)):this.selectedUser=""},onUserCreated:function(e){this.userCreatedText=`${this.userCreatedInitialText} username: ${e.username} \n password: ${e.password}`,this.showUserCreatedModal=!0,this.getUsersList()},onUserDeleted:function(){this.showUserDeletedModal=!0,this.getUsersList()},onPermissionsChanged:function(e,s){this.showUsersPermissionsChangedModal=!0,this.usersList.find(e=>e.username===s).permissions=e},getUsersList:function(){this.loadInProgress=!0,Ee.get("/users").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;this.usersList=e.data}).catch(e=>{je(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})}},beforeMount(){this.getUsersList()}},Te=Le,De=(t("e36f"),Object(b["a"])(Te,ue,fe,!1,null,"30227fb4",null)),qe=De.exports,Ne=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"platform-config"},[t("h2",[e._v("Platform Configuration")]),e.loadFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to retrieve configuration from the server.")]),t("p",[e._v("Please try again later.")])])]):e._e(),e.updateInProgress||e.loadInProgress?t("loader",{attrs:{loading:e.updateInProgress}}):e._e(),e.updateFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[t("p",[e._v("Unable to update configuration.")]),t("p",[e._v("Verify provided information or try again later.")])])]):e._e(),t("br"),t("b-card",{attrs:{"no-body":""}},[0!==Object.keys(e.config).length?t("b-tabs",{attrs:{pills:"",justified:"",card:""}},e._l(e.config,(function(e,s){return t("b-tab",{key:s,attrs:{"title-link-class":"tab-title",title:e.name}},[t("ConfigTable",{attrs:{initialConfigSection:s}})],1)})),1):e._e()],1),0!==Object.keys(e.config).length&&e.canUpdateSettings?t("b-card",[t("b-button",{attrs:{variant:"success"},on:{click:e.updateConfig}},[e._v("Update ")])],1):e._e(),t("transition",{attrs:{name:"modal"}},[e.showModal?t("UpdateReportModal",{attrs:{updateReport:e.updateConfigReport},on:{updateReportModalClosed:function(s){e.showModal=!1}}}):e._e()],1)],1)},Be=[],Ae=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"config-table"},[t("b-table",{attrs:{striped:"",hover:"","sticky-header":"42em",responsive:"",fixed:"","head-variant":"light",items:e.displayConfig,fields:e.tableHeaders},scopedSlots:e._u([{key:"cell(property)",fn:function(s){return[t("div",{staticClass:"tab-cell"},[e._v(e._s(s.item.property))])]}},{key:"cell(value)",fn:function(s){return[t("VJsoneditor",{staticClass:"editor",attrs:{plus:!1,options:{onChangeText:function(t){e.onValueChanged(t,s.item.property)},search:!1,navigationBar:!1,mode:"TEMPLATE_VERSION"===s.item.property?"view":"tree",onEditable:e.forbidCertainEditions}},model:{value:s.item.value,callback:function(t){e.$set(s.item,"value",t)},expression:"row.item.value"}})]}},{key:"cell(description)",fn:function(s){return[t("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"tab-cell",domProps:{innerHTML:e._s(s.item.description)}})]}}])})],1)},Ve=[],He=a["default"].observable({state:{config:{}}}),Je=t("27f7"),ze={name:"ConfigTable",props:{initialConfigSection:String},components:{VJsoneditor:Je["a"]},data:function(){return{configSection:this.initialConfigSection,tableHeaders:[{key:"property",label:"Property",thStyle:{"text-align":"center"}},{key:"value",label:"Value",thStyle:{"text-align":"center"}},{key:"description",label:"Description",thStyle:{"text-align":"center"}}]}},computed:{canUpdateSettings:()=>G.canUpdateSettings(),config:function(){return He.state.config[this.configSection].settings},displayConfig:function(){return Object.keys(this.config).map(function(e){const s=this.config[e].description?this.config[e].description:null;let t=this.config[e];return Object.prototype.hasOwnProperty.call(t,"value")&&(t=t.value),t||"boolean"===typeof t?"object"===typeof t?t=JSON.stringify(t):"string"!==typeof t&&(t=String(t)):t="",{property:e,value:this.isJSON(t)?JSON.parse(t):t,description:s}}.bind(this))}},methods:{forbidCertainEditions:function(e){return!!this.canUpdateSettings&&("description"!==e.field&&(!e.field||{field:!1,value:!0}))},onValueChanged:function(e,s){this.config[s].value=e},isJSON:function(e){try{JSON.parse(e)}catch(s){return!1}return!0}}},Ge=ze,Ke=(t("7728"),Object(b["a"])(Ge,Ae,Ve,!1,null,"d0c9c050",null)),Ye=Ke.exports,Qe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("Modal",{on:{close:function(s){return e.$emit("updateReportModalClosed")}}},[t("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Update report")]),t("div",{attrs:{slot:"body"},slot:"body"},[Object.keys(e.updateReport.successes).length>0?t("div",[t("h4",[e._v("Successes")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.successes}})],1):e._e(),Object.keys(e.updateReport.failures).length>0?t("div",[t("h4",[e._v("Failures")]),t("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.failures}})],1):e._e()])])},We=[],Xe={name:"UpdateReportModal",components:{Modal:C},props:{updateReport:{}},computed:{successes:function(){return Object.keys(this.updateReport.successes).map(function(e){return{url:this.updateReport.successes[e].url,role:this.updateReport.successes[e].role}}.bind(this))},failures:function(){return Object.keys(this.updateReport.failures).map(function(e){return{url:this.updateReport.failures[e].url,role:this.updateReport.failures[e].role,error:this.updateReport.failures[e].error}}.bind(this))}}},Ze=Xe,es=(t("ace3"),Object(b["a"])(Ze,Qe,We,!1,null,"24cc2062",null)),ss=es.exports;const ts=t("bc3a"),{handleHttpErrors:as}=t("dc5b");var rs={name:"Config",components:{ConfigTable:Ye,UpdateReportModal:ss,Loader:q},data:()=>({loadFailed:!1,updateFailed:!1,showModal:!1,updateConfigReport:{},updateInProgress:!1,loadInProgress:!1}),computed:{config:()=>He.state.config,canUpdateSettings:()=>G.canUpdateSettings()},methods:{getConfig:function(){He.state.config={},this.loadInProgress=!0,ts.get("/admin/settings").then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;He.state.config=e.data}).catch(e=>{as(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})},updateConfig:function(){this.updateInProgress=!0,this.updateFailed=!1,ts.put("/admin/settings",He.state.config).then(()=>ts.post("/admin/notify",{})).then(e=>{if(!e.data||!Object.hasOwnProperty.call(e.data,"successes")||!Object.hasOwnProperty.call(e.data,"failures"))throw new Error;this.updateConfigReport=e.data,this.showModal=!0}).catch(()=>{this.updateFailed=!0}).finally(()=>{this.updateInProgress=!1})},resetFailureIndicators:function(){this.loadFailed=!1,this.updateFailed=!1}},beforeMount(){this.getConfig()}},os=rs,ns=(t("ff5d"),Object(b["a"])(os,Ne,Be,!1,null,"3887f7d4",null)),is=ns.exports,ls=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"login"},[t("h1",[e._v("Administration Panel")]),t("h3",[e._v("Please log in")]),t("b-card",[t("b-form",{on:{submit:function(s){return s.preventDefault(),e.login(s)}}},[t("b-form-group",{attrs:{"label-for":"serverUrl",label:"Config leader address"}},[t("b-form-input",{attrs:{required:"",pattern:"https?://\\S+",type:"text",name:"serverUrl",id:"serverUrl",placeholder:"https://lead.platform.com"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.serverUrl,callback:function(s){e.serverUrl=s},expression:"serverUrl"}})],1),t("b-form-group",{attrs:{"label-for":"username",label:"Username"}},[t("b-form-input",{attrs:{required:"",type:"text",name:"username",id:"username",placeholder:"Username"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.username,callback:function(s){e.username=s},expression:"username"}})],1),t("b-form-group",{attrs:{"label-for":"password",label:"Password"}},[t("b-form-input",{attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Password"},on:{input:function(s){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.password,callback:function(s){e.password=s},expression:"password"}})],1),t("b-button",{attrs:{variant:"success",type:"submit"}},[e._v("Login")])],1)],1),e.loginFailed?t("b-card",[t("div",{staticClass:"failure-msg"},[e.loginRequestFailed?e._e():t("p",[e._v(" Incorrect credentials. Please verify your input ")]),e.loginRequestFailed?t("p",[e._v(" Unable to connect to the server. Please try again later ")]):e._e()])]):e._e(),e.loginInProgress?t("loader",{attrs:{loading:e.loginInProgress}}):e._e()],1)},ds=[];const cs=t("04e1"),us=t("bc3a");var fs={name:"Login",components:{Loader:q},data:()=>({serverUrl:"",username:"",password:"",loginFailed:!1,loginRequestFailed:!1,loginInProgress:!1}),methods:{login:function(){this.loginInProgress=!0,us.post(this.serverUrl+"/auth/login",{username:this.username,password:this.password}).then(e=>{if(!e.data||0===Object.keys(e.data).length||!e.data.token)throw new Error;localStorage.setItem("serverUrl",this.serverUrl),localStorage.setItem("token",e.data.token);const s=cs(e.data.token);localStorage.setItem("permissions",JSON.stringify(s.permissions)),localStorage.setItem("username",s.username),us.defaults.baseURL=this.serverUrl,us.defaults.headers.common["authorization"]=e.data.token,this.$emit("loggedIn"),this.$router.push("/")}).catch(e=>{(e&&e.response&&e.response.status&&e.response.status>=500||"Network Error"===e.message)&&(this.loginRequestFailed=!0),this.loginFailed=!0}).finally(()=>{this.loginInProgress=!1})}}},ps=fs,ms=(t("3f3b"),Object(b["a"])(ps,ls,ds,!1,null,"3af00744",null)),hs=ms.exports;a["default"].use(re["a"]);const gs=[{path:"/",name:"Home",component:ce},{path:"/login",name:"Login",component:hs},{path:"/users-management",name:"UsersManagement",component:qe},{path:"/platform-config",name:"Config",component:is}],vs=new re["a"]({routes:gs});var bs=vs;a["default"].config.productionTip=!1,new a["default"]({router:bs,render:e=>e(ae)}).$mount("#app")},"5fc0":function(e,s,t){"use strict";var a=t("adbf"),r=t.n(a);r.a},6:function(e,s){},"63a0":function(e,s,t){"use strict";var a=t("c8da"),r=t.n(a);r.a},7:function(e,s){},7728:function(e,s,t){"use strict";var a=t("2bc4"),r=t.n(a);r.a},"7c31":function(e,s,t){},8:function(e,s){},"85ec":function(e,s,t){},9:function(e,s){},"9da0":function(e,s,t){},ace3:function(e,s,t){"use strict";var a=t("018c"),r=t.n(a);r.a},adbf:function(e,s,t){},b24f:function(e,s,t){"use strict";var a=t("fced"),r=t.n(a);r.a},c82d:function(e,s,t){},c8da:function(e,s,t){},cf05:function(e,s,t){e.exports=t.p+"img/logo.54cacaa3.png"},d609:function(e,s,t){"use strict";var a=t("9da0"),r=t.n(a);r.a},d86b:function(e,s,t){"use strict";var a=t("f54a"),r=t.n(a);r.a},dc5b:function(e,s,t){"use strict";t.r(s),t.d(s,"handleHttpErrors",(function(){return a}));const a=function(e,s){if(e&&e.response)return 401===e.response.status&&"Invalid token"===e.response.data.error.message&&(localStorage.removeItem("token"),s.$emit("loggedOut"),s.$router.push("/login"),!0)}},df64:function(e,s,t){"use strict";var a=t("058e"),r=t.n(a);r.a},e36f:function(e,s,t){"use strict";var a=t("f8e0"),r=t.n(a);r.a},f54a:function(e,s,t){},f8e0:function(e,s,t){},fced:function(e,s,t){},ff5d:function(e,s,t){"use strict";var a=t("c82d"),r=t.n(a);r.a}});
//# sourceMappingURL=app.8e50066d.js.map