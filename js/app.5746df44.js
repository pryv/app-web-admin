(function(e){function t(t){for(var a,n,i=t[0],l=t[1],d=t[2],u=0,m=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&m.push(o[n][0]),o[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(m.length)m.shift()();return r.push.apply(r,d||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,i=1;i<s.length;i++){var l=s[i];0!==o[l]&&(a=!1)}a&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var a={},o={app:0},r=[];function n(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=a,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var c=l;r.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"00c4":function(e,t,s){"use strict";var a=s("5283"),o=s.n(a);o.a},"010e":function(e,t,s){"use strict";var a=s("73c6"),o=s.n(a);o.a},"034f":function(e,t,s){"use strict";var a=s("85ec"),o=s.n(a);o.a},"0ea4":function(e,t,s){},1:function(e,t){},1581:function(e,t,s){"use strict";var a=s("7af1"),o=s.n(a);o.a},2:function(e,t){},3:function(e,t){},"3a30":function(e,t,s){},4:function(e,t){},4379:function(e,t,s){"use strict";var a=s("f576"),o=s.n(a);o.a},5:function(e,t){},5126:function(e,t,s){},5283:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);var a=s("2b0e"),o=s("5f5b"),r=s("b1e0");s("ab8b"),s("2dd8");a["default"].use(o["a"]),a["default"].use(r["a"]);var n=s("9aa5"),i=s.n(n);a["default"].directive("linkified",i.a);var l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("NavBar",{attrs:{loggedIn:e.loggedIn},on:{loggedOut:function(t){e.loggedIn=!1}}}),s("b-container",{attrs:{fluid:""}},[s("b-row",{attrs:{"align-h":"center"}},[s("b-col",[s("router-view",{on:{loggedIn:function(t){e.loggedIn=!0},loggedOut:function(t){e.loggedIn=!1}}})],1)],1)],1)],1)},d=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-navbar",{staticClass:"navbar-expand-lg, navbar-light, bg-light",attrs:{fixed:"top"}},[a("b-navbar-brand",{attrs:{href:"https://api.pryv.com"}},[a("img",{staticClass:"d-inline-block align-top",attrs:{alt:"Logo",src:s("cf05"),width:"100px"}})]),e.loggedIn?a("b-navbar-toggle",{attrs:{target:"nav-collapse"}}):e._e(),e.loggedIn?a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",{staticClass:"ml-auto",attrs:{tag:"div"}},[e.canViewPlatformConfig?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/platform-config"}},[e._v("Platform Configuration")]):e._e(),e.canViewAdminUsers?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/admin-users"}},[e._v("Admin Users")]):e._e(),e.canReadPlatformUsers?a("b-nav-item",{staticClass:"nav-view",attrs:{to:"/platform-users"}},[e._v("Platform Users")]):e._e()],1),a("b-navbar-nav",{attrs:{align:"right",tag:"div"}},[a("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:e._u([{key:"button-content",fn:function(){return[a("em",[e._v(e._s(e.username))])]},proxy:!0}],null,!1,1747042283)},[a("b-dropdown-item",{on:{click:function(t){e.displayChangePasswordModal=!0}}},[e._v("Change Password")]),a("b-dropdown-item",{on:{click:function(t){return e.logout()}}},[e._v("Sign Out")])],1)],1)],1):e._e()],1),a("transition",{attrs:{name:"modal"}},[e.displayChangePasswordModal?a("PasswordChangeModal",{on:{close:function(t){e.displayChangePasswordModal=!1}}}):e._e()],1)],1)},u=[],m=s("bc3a"),f=s.n(m),p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Modal",{on:{close:function(t){return e.$emit("close")}}},[s("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Enter new password")]),s("div",{attrs:{slot:"body"},slot:"body"},[s("b-form",{on:{submit:function(t){return t.preventDefault(),e.requestPasswordChange(t)}}},[s("b-form-group",{attrs:{"label-for":"oldPassword"}},[s("b-form-input",{attrs:{required:"",type:"password",name:"oldPassword",id:"oldPassword",placeholder:"Old Password"},on:{input:function(t){e.passwordChangeFailed=!1}},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}})],1),s("b-form-group",{attrs:{"label-for":"newPassword"}},[s("b-form-input",{attrs:{required:"",type:"password",name:"newPassword",id:"newPassword",placeholder:"New Password"},on:{input:function(t){e.passwordChangeFailed=!1}},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),s("b-form-group",{attrs:{"label-for":"newPasswordCheck"}},[s("b-form-input",{attrs:{required:"",type:"password",name:"newPasswordCheck",id:"newPasswordCheck",placeholder:"Confirm Password"},on:{input:function(t){e.passwordChangeFailed=!1}},model:{value:e.newPasswordCheck,callback:function(t){e.newPasswordCheck=t},expression:"newPasswordCheck"}})],1),s("div",{staticClass:"modal-footer"},[s("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v(" Save ")]),s("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.passwordChangeFailed?s("b-card",[s("div",{staticClass:"failure-msg"},[s("p",[e._v("Password change failed")]),s("p",[e._v("Please try again later")])])]):e._e(),e.passwordChangeSuccessful?s("b-card",[s("div",{staticClass:"success-msg"},[s("p",[e._v("Password successfully changed")])])]):e._e()],1),s("div",{attrs:{slot:"footer"},slot:"footer"})]),s("transition",{attrs:{name:"modal"}},[e.showFailureModal?s("OperationFailedModal",{on:{close:function(t){e.showFailureModal=!1}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showPasswordChangedModal?s("OperationSuccessfulModal",{attrs:{text:e.passwordChangedText},on:{close:function(t){return e.$emit("close")}}}):e._e()],1),e.showLoader?s("loader",{attrs:{loading:e.showLoader}}):e._e()],1)},h=[],g=s("04e1"),v=s.n(g),b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-mask"},[s("div",{staticClass:"modal-wrapper"},[s("div",{staticClass:"modal-container"},[s("div",{staticClass:"modal-header"},[e._t("header",[e._v(e._s(e.header))]),s("div",{staticClass:"close-button",on:{click:function(t){return e.$emit("close")}}},[e._v("x")])],2),s("div",{staticClass:"modal-body"},[e._t("body",[e._v(e._s(e.body))])],2),s("div",{staticClass:"modal-footer"},[e._t("footer",[e.showCancelButton?s("b-button",{staticClass:"btn-outline-primary",attrs:{variant:"danger"},on:{click:function(t){return e.$emit("close")}}},[e._v("Cancel")]):e._e(),s("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$emit("close")}}},[e._v("OK")]),s("br")])],2)])])])},w=[],C={name:"Modal",props:{header:String,body:String,showCancelButton:Boolean}},y=C,M=(s("f890"),s("2877")),_=Object(M["a"])(y,b,w,!1,null,"6a1c3082",null),P=_.exports,U=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"operation-successful-modal-mask"},[s("div",{staticClass:"operation-successful-modal-wrapper"},[s("div",{staticClass:"operation-successful-modal-container"},[s("div",{staticClass:"operation-successful-modal-body"},[s("b-iconstack",{attrs:{"font-scale":"10"}},[s("b-icon",{attrs:{stacked:"",icon:"circle",variant:"secondary"}}),s("b-icon",{attrs:{stacked:"",icon:"check",variant:"secondary"}})],1),s("div",{staticClass:"operation-successful-modal-message"},[e._v(e._s(e.text))]),s("b-button",{attrs:{variant:"outline-secondary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Close ")])],1)])])])},k=[],x={name:"OperationSuccessfulModal",props:{text:String}},S=x,O=(s("6586"),Object(M["a"])(S,U,k,!1,null,"8e697160",null)),I=O.exports,$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"operation-failed-modal-mask"},[s("div",{staticClass:"operation-failed-modal-wrapper",on:{click:function(t){return e.$emit("close")}}},[s("div",{staticClass:"operation-failed-modal-container"},[s("div",{staticClass:"operation-failed-modal-body"},[s("b-iconstack",{attrs:{"font-scale":"10"}},[s("b-icon",{attrs:{stacked:"",icon:"circle",variant:"danger"}}),s("b-icon",{attrs:{stacked:"",icon:"x",variant:"danger"}})],1),s("div",{staticClass:"operation-failed-modal-message"},[e._v(" Failed to process the request. Verify your input or try again later ")])],1)])])])},R=[],F={name:"OperationFailedModal"},L=F,E=(s("b24f"),Object(M["a"])(L,$,R,!1,null,"e9f76e9c",null)),D=E.exports,T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"loader-mask"},[s("div",{staticClass:"loader-wrapper"},[s("pulse-loader")],1)])},A=[],j=s("8a5d"),N={name:"Loader",components:{PulseLoader:j["a"]}},V=N,J=(s("d609"),Object(M["a"])(V,T,A,!1,null,"97a2206a",null)),B=J.exports,q={name:"PasswordChangeModal",components:{Modal:P,OperationSuccessfulModal:I,OperationFailedModal:D,Loader:B},data:()=>({oldPassword:"",newPassword:"",newPasswordCheck:"",passwordChangeFailed:!1,passwordChangeSuccessful:!1,passwordProvided:!0,passwordChangedText:"Password changed successfully",showPasswordChangedModal:!1,showFailureModal:!1,showLoader:!1}),methods:{requestPasswordChange:function(){this.showLoader=!0;const e=localStorage.getItem("token"),t=v()(e).username;f.a.post(`/users/${t}/change-password`,{oldPassword:this.oldPassword,newPassword:this.newPassword,newPasswordCheck:this.newPasswordCheck}).then(()=>{this.showPasswordChangedModal=!0}).catch(()=>{this.showFailureModal=!0}).finally(()=>this.showLoader=!1)}}},H=q,z=(s("7bca"),Object(M["a"])(H,p,h,!1,null,"5e9764fe",null)),W=z.exports,G=a["default"].observable({state:{config:{},currentUser:{username:localStorage.getItem("username")||"",permissions:JSON.parse(localStorage.getItem("permissions"))||[]}}});const K=function(e){const t=G.state.currentUser.permissions;return t&&t[e]&&Array.isArray(t[e])?t[e]:[]};class Q{static canReadSettings(){return K("settings").includes("read")}static canUpdateSettings(){return K("settings").includes("update")}static canReadAdminUsers(){return K("users").includes("read")}static canCreateAdminUsers(){return K("users").includes("create")}static canDeleteAdminUsers(){return K("users").includes("delete")}static canResetPassword(){return K("users").includes("resetPassword")}static canChangePermissions(){return K("users").includes("changePermissions")}static canReadPlatformUsers(){return K("platformUsers").includes("read")}static canModifyPlatformUsers(){return K("platformUsers").includes("modify")}static canDeletePlatformUsers(){return K("platformUsers").includes("delete")}}var Y={name:"NavBar",components:{PasswordChangeModal:W},props:{loggedIn:Boolean},data:()=>({displayChangePasswordModal:!1,username:G.state.currentUser.username}),computed:{canViewPlatformConfig:()=>Q.canReadSettings(),canViewAdminUsers:()=>Q.canReadAdminUsers(),canReadPlatformUsers:()=>Q.canReadPlatformUsers()},methods:{logout:function(){f.a.post("/auth/logout",{}).finally(()=>{localStorage.removeItem("token"),localStorage.removeItem("permissions"),localStorage.removeItem("username"),localStorage.removeItem("serverUrl"),this.$emit("loggedOut"),this.$router.push("/login")})}}},X=Y,Z=(s("e888"),Object(M["a"])(X,c,u,!1,null,"0213eaac",null)),ee=Z.exports,te={name:"App",components:{NavBar:ee},data:()=>({loggedIn:!1}),beforeMount(){this.loggedIn=!!localStorage.getItem("token"),this.loggedIn&&(f.a.defaults.baseURL=localStorage.getItem("serverUrl"),f.a.defaults.headers.common["authorization"]=localStorage.getItem("token"))}},se=te,ae=(s("034f"),Object(M["a"])(se,l,d,!1,null,null,null)),oe=ae.exports,re=s("8c4f"),ne=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"home"})},ie=[],le={name:"Home",beforeMount(){localStorage.getItem("token")?Q.canReadSettings()?this.$router.push("/platform-config"):Q.canReadAdminUsers()&&this.$router.push("/admin-users"):this.$router.push("/login")}},de=le,ce=Object(M["a"])(de,ne,ie,!1,null,null,null),ue=ce.exports,me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"admin-users"},[s("h2",[e._v("Admin Users")]),e.loadFailed?s("b-card",[s("div",{staticClass:"failure-msg"},[s("p",[e._v("Unable to retrieve users list from the server.")]),s("p",[e._v("Please try again later.")])])]):e._e(),s("b-table",{attrs:{striped:"",hover:"","sticky-header":"43em",responsive:"",fixed:"",selectable:"","select-mode":"single","head-variant":"light",items:e.usersList,fields:e.tableHeaders,"primary-key":"username"},on:{"row-selected":e.onRowSelected},scopedSlots:e._u([{key:"cell(users)",fn:function(t){return[e._v(" "+e._s(t.item.username)+" ")]}},{key:"cell(permissions)",fn:function(t){return[s("PermissionsTable",{attrs:{username:t.item.username,permissions:t.item.permissions,disableCheckBoxes:!0},on:{permissionsTableClicked:e.onRowSelected}})]}}])}),s("b-card",[e.canCreate?s("b-button",{attrs:{variant:"primary"},on:{click:function(t){e.showCreateUserModal=!0}}},[e._v(" Create ")]):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showEditUserModal?s("CreateEditUserModal",{attrs:{edit:!0,username:e.selectedUser.username,permissions:Object.assign({},e.selectedUser.permissions)},on:{close:function(t){e.showEditUserModal=!1},permissionsChanged:function(t){return e.onPermissionsChanged(t,e.selectedUser.username)},passwordResetDone:function(t){return e.onPasswordResetDone(t)},userDeleted:function(t){return e.onUserDeleted()}}}):e._e()],1),e.loadInProgress?s("loader",{attrs:{loading:e.loadInProgress}}):e._e(),s("transition",{attrs:{name:"modal"}},[e.showCreateUserModal?s("CreateEditUserModal",{attrs:{create:!0,permissions:{users:[],settings:[],platformUsers:[]}},on:{close:function(t){e.showCreateUserModal=!1},userCreated:function(t){return e.onUserCreated(t)}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showUsersPermissionsChangedModal?s("OperationSuccessfulModal",{attrs:{text:e.usersPermissionsChangedText},on:{close:function(t){return e.onUsersPermissionsChangedModalClose()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showUsersPasswordResetedModal?s("OperationSuccessfulModal",{attrs:{text:e.usersPasswordResetedText},on:{close:function(t){return e.onUsersPasswordResetedModalClose()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showUserDeletedModal?s("OperationSuccessfulModal",{attrs:{text:e.userDeletedText},on:{close:function(t){return e.onUserDeletedModalClose()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showUserCreatedModal?s("OperationSuccessfulModal",{attrs:{text:e.userCreatedText},on:{close:function(t){return e.onUserCreatedModalClose()}}}):e._e()],1)],1)},fe=[],pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"create-edit-user-modal"},[s("Modal",{on:{close:function(t){return e.$emit("close")}}},[s("h3",{attrs:{slot:"header"},slot:"header"},[e._v(e._s(e.headerStart)+" user")]),s("div",{attrs:{slot:"body"},slot:"body"},[s("b-form",{on:{submit:function(t){return t.preventDefault(),e.saveChanges(t)}}},[s("b-form-group",{attrs:{label:"Username"}},[s("b-form-input",{attrs:{required:"",disabled:e.edit,type:"text",name:"username",id:"username",placeholder:"Username"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),e.create?s("b-form-group",{attrs:{label:"Password"}},[s("b-form-input",{attrs:{required:"",type:"text",name:"password",id:"password",placeholder:"Password"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e(),s("b-form-group",{attrs:{label:"Permissions"}},[s("br"),e.atLeastOnePermissionSelected?e._e():s("b-alert",{attrs:{show:"",variant:"warning"}},[e._v(" Please select at least one permission ")]),s("PermissionsTable",{attrs:{permissions:e.permissions,disableCheckBoxes:e.edit&&!e.canChangePermissions}})],1),s("div",{staticClass:"modal-footer"},[s("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v(" Save ")]),s("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")])],1)],1),e.edit?s("div",[s("hr"),e.canResetPassword?s("b-button",{staticClass:"btn-sm",attrs:{variant:"outline-secondary"},on:{click:function(t){e.showResetPasswordConfirmationModal=!0}}},[e._v(" Reset password ")]):e._e(),e.canDelete?s("b-button",{staticClass:"btn-sm",attrs:{variant:"outline-primary"},on:{click:function(t){e.showDeleteConfirmationModal=!0}}},[e._v(" Delete ")]):e._e()],1):e._e()],1),s("div",{attrs:{slot:"footer"},slot:"footer"})]),e.showLoader?s("loader",{attrs:{loading:e.showLoader}}):e._e(),s("transition",{attrs:{name:"modal"}},[e.showResetPasswordConfirmationModal?s("ConfirmationModal",{attrs:{text:e.resetPasswordConfirmationMsg},on:{close:function(t){e.showResetPasswordConfirmationModal=!1},confirm:function(t){return e.resetPassword()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showDeleteConfirmationModal?s("ConfirmationModal",{attrs:{text:e.deleteConfirmationMsg},on:{close:function(t){e.showDeleteConfirmationModal=!1},confirm:function(t){return e.deleteUser()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showFailureModal?s("OperationFailedModal",{on:{close:function(t){e.showFailureModal=!1}}}):e._e()],1)],1)},he=[],ge=s("4556"),ve=s.n(ge),be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"permissions-table"},[s("table",{on:{click:function(t){return e.$emit("permissionsTableClicked",[{username:e.username,permissions:e.permissions}])}}},[e._m(0),s("tr",[e._l(e.usersPermissions,(function(t){return s("td",{key:"users-perm-"+t},[e._v(" "+e._s(t)+" ")])})),e._l(e.settingsPermissions,(function(t){return s("td",{key:"settings-perm-"+t},[e._v(" "+e._s(t)+" ")])})),e._l(e.platformUsersPermissions,(function(t){return s("td",{key:"platform-users-perm-"+t},[e._v(" "+e._s(t)+" ")])}))],2),s("tr",[e._l(e.usersPermissions,(function(t){return s("td",{key:"users-perm-"+t},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.users,expression:"permissions.users"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:t,checked:Array.isArray(e.permissions.users)?e._i(e.permissions.users,t)>-1:e.permissions.users},on:{change:function(s){var a=e.permissions.users,o=s.target,r=!!o.checked;if(Array.isArray(a)){var n=t,i=e._i(a,n);o.checked?i<0&&e.$set(e.permissions,"users",a.concat([n])):i>-1&&e.$set(e.permissions,"users",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"users",r)}}})])})),e._l(e.settingsPermissions,(function(t){return s("td",{key:"settings-perm-"+t},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.settings,expression:"permissions.settings"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:t,checked:Array.isArray(e.permissions.settings)?e._i(e.permissions.settings,t)>-1:e.permissions.settings},on:{change:function(s){var a=e.permissions.settings,o=s.target,r=!!o.checked;if(Array.isArray(a)){var n=t,i=e._i(a,n);o.checked?i<0&&e.$set(e.permissions,"settings",a.concat([n])):i>-1&&e.$set(e.permissions,"settings",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"settings",r)}}})])})),e._l(e.platformUsersPermissions,(function(t){return s("td",{key:"platform-users-perm-"+t},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.permissions.platformUsers,expression:"permissions.platformUsers"}],attrs:{type:"checkbox",disabled:e.disableCheckBoxes},domProps:{value:t,checked:Array.isArray(e.permissions.platformUsers)?e._i(e.permissions.platformUsers,t)>-1:e.permissions.platformUsers},on:{change:function(s){var a=e.permissions.platformUsers,o=s.target,r=!!o.checked;if(Array.isArray(a)){var n=t,i=e._i(a,n);o.checked?i<0&&e.$set(e.permissions,"platformUsers",a.concat([n])):i>-1&&e.$set(e.permissions,"platformUsers",a.slice(0,i).concat(a.slice(i+1)))}else e.$set(e.permissions,"platformUsers",r)}}})])}))],2)])])},we=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",[s("th",{attrs:{colspan:"5"}},[e._v("ADMIN USERS")]),s("th",{attrs:{colspan:"2"}},[e._v("SETTINGS")]),s("th",{attrs:{colspan:"2"}},[e._v("PLATFORM USERS")])])}],Ce={name:"PermissionsTable",props:{username:String,permissions:{},disableCheckBoxes:Boolean},data:()=>({settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"],platformUsersPermissions:["read","delete","modify"]})},ye=Ce,Me=(s("00c4"),Object(M["a"])(ye,be,we,!1,null,"4971dd00",null)),_e=Me.exports,Pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"confirmation-modal-mask"},[s("div",{staticClass:"confirmation-modal-wrapper"},[s("div",{staticClass:"confirmation-modal-container"},[s("div",{staticClass:"confirmation-modal-body"},[s("div",{staticClass:"confirmation-close-button",on:{click:function(t){return e.$emit("close")}}},[e._v("x")]),s("div",{staticClass:"confirmation-text"},[e._v(e._s(e.text))])]),s("div",{staticClass:"confirmation-modal-footer"},[s("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),s("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$emit("confirm")}}},[e._v("Yes")]),s("br")],1)])])])},Ue=[],ke={name:"ConfirmationModal",props:{text:String}},xe=ke,Se=(s("010e"),Object(M["a"])(xe,Pe,Ue,!1,null,"5909e592",null)),Oe=Se.exports;const Ie=function(e,t){if(e&&e.response)return 401===e.response.status&&"Invalid token"===e.response.data.error.message&&(localStorage.removeItem("token"),t.$emit("loggedOut"),t.$router.push("/login"),!0)};var $e={name:"CreateEditUserModal",props:{edit:Boolean,create:Boolean,username:String,permissions:{}},components:{Modal:P,PermissionsTable:_e,ConfirmationModal:Oe,Loader:B,OperationFailedModal:D},data:function(){return{password:"",showResetPasswordConfirmationModal:!1,showDeleteConfirmationModal:!1,resetPasswordConfirmationMsg:"Are you sure you want to reset the password of this user?",deleteConfirmationMsg:"Are you sure you want to delete this user?",showLoader:!1,showFailureModal:!1,atLeastOnePermissionSelected:!0}},computed:{headerStart:function(){return this.edit?"Edit":"Create"},canChangePermissions:()=>Q.canChangePermissions(),canResetPassword:()=>Q.canResetPassword(),canDelete:()=>Q.canDeleteAdminUsers()},methods:{saveChanges:function(){this.create?this.createUser():this.edit&&this.changePermissions()},isSelectedPermissionsValid(){return 0===this.permissions.users.length&&0===this.permissions.settings.length&&0===this.permissions.platformUsers.length?(this.showFailureModal=!1,this.atLeastOnePermissionSelected=!1,!1):(this.atLeastOnePermissionSelected=!0,!0)},createUser(){this.isSelectedPermissionsValid()&&(this.showLoader=!0,f.a.post("/users",{username:this.username,password:this.password,permissions:this.permissions}).then(()=>{this.$emit("userCreated",{username:this.username,password:this.password})}).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1))},changePermissions(){this.showLoader=!0,f.a.put(`/users/${this.username}/permissions`,{permissions:this.permissions}).then(()=>{this.$emit("permissionsChanged",this.permissions)}).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},resetPassword(){this.showResetPasswordConfirmationModal=!1,this.showLoader=!0,f.a.post(`/users/${this.username}/reset-password`,{}).then(e=>{this.$emit("passwordResetDone",e.data)}).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},deleteUser(){this.showDeleteConfirmationModal=!1,this.showLoader=!0,f.a.delete("/users/"+this.username).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).then(()=>{this.$emit("userDeleted")}).finally(()=>this.showLoader=!1)}},beforeMount(){this.password=ve()({length:10,type:"url-safe"})}},Re=$e,Fe=(s("b062"),Object(M["a"])(Re,pe,he,!1,null,"715b6b74",null)),Le=Fe.exports,Ee={name:"AdminUsers",components:{Loader:B,CreateEditUserModal:Le,PermissionsTable:_e,OperationSuccessfulModal:I},data:()=>({usersList:[],loadFailed:!1,loadInProgress:!1,selectedUser:{},tableHeaders:[{key:"users",label:"Username",thStyle:{"text-align":"center"},class:"admin-users-user-row"},{key:"permissions",label:"Permissions",thStyle:{"text-align":"center"}}],settingsPermissions:["read","update"],usersPermissions:["read","create","delete","resetPassword","changePermissions"],showCreateUserModal:!1,showEditUserModal:!1,showUserDeletedModal:!1,userDeletedText:"User deleted successfully",showUserCreatedModal:!1,userCreatedInitialText:"User created successfully.",userCreatedText:"",showUsersPasswordResetedModal:!1,usersPasswordResetedInitialText:"User's password reset successful.",usersPasswordResetedText:"",showUsersPermissionsChangedModal:!1,usersPermissionsChangedText:"User's permissions updated successfully"}),computed:{canChangePermissions:()=>Q.canChangePermissions(),canCreate:()=>Q.canCreateAdminUsers()},methods:{onUsersPermissionsChangedModalClose:function(){this.showUsersPermissionsChangedModal=!1,this.showEditUserModal=!1},onUsersPasswordResetedModalClose:function(){this.showUsersPasswordResetedModal=!1,this.showEditUserModal=!1},onUserDeletedModalClose:function(){this.showUserDeletedModal=!1,this.showEditUserModal=!1},onUserCreatedModalClose:function(){this.showUserCreatedModal=!1,this.showCreateUserModal=!1},onPasswordResetDone:function(e){this.usersPasswordResetedText=`${this.usersPasswordResetedInitialText} New password: ${e.password}`,this.showUsersPasswordResetedModal=!0},onRowSelected:function(e){e&&e.length>0?(this.selectedUser=e[0],this.canChangePermissions&&(this.showEditUserModal=!0)):this.selectedUser=""},onUserCreated:function(e){this.userCreatedText=`${this.userCreatedInitialText} username: ${e.username} \n password: ${e.password}`,this.showUserCreatedModal=!0,this.getUsersList()},onUserDeleted:function(){this.showUserDeletedModal=!0,this.getUsersList()},onPermissionsChanged:function(e,t){this.showUsersPermissionsChangedModal=!0,this.usersList.find(e=>e.username===t).permissions=e,this.updateCurrentUserIfNeeded(t,e)},updateCurrentUserIfNeeded(e,t){e===localStorage.getItem("username")&&(localStorage.setItem("permissions",JSON.stringify(t)),G.state.currentUser.permissions=t)},getUsersList:function(){this.loadInProgress=!0,f.a.get("/users").then(e=>{if(null==e.data||null==e.data.users)throw new Error("Missing users property");this.usersList=e.data.users,this.usersList.forEach(e=>{for(let t of["users","platformUsers","settings"])e.permissions[t]||(e.permissions[t]=[])})}).catch(e=>{Ie(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})}},beforeMount(){this.getUsersList()}},De=Ee,Te=(s("6cac"),Object(M["a"])(De,me,fe,!1,null,"40af21d4",null)),Ae=Te.exports,je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"platform-config"},[s("h2",[e._v("Platform Configuration")]),e.loadFailed?s("b-card",[s("div",{staticClass:"failure-msg"},[s("p",[e._v("Unable to retrieve configuration from the server.")]),s("p",[e._v("Please try again later.")])])]):e._e(),e.updateInProgress||e.loadInProgress?s("loader",{attrs:{loading:e.updateInProgress}}):e._e(),e.updateFailed?s("b-card",[s("div",{staticClass:"failure-msg"},[s("p",[e._v("Unable to update configuration.")]),s("p",[e._v("Verify provided information or try again later.")])])]):e._e(),s("br"),s("b-card",{attrs:{"no-body":""}},[0!==Object.keys(e.config).length?s("b-tabs",{attrs:{pills:"",justified:"",card:""},model:{value:e.activeTabIndex,callback:function(t){e.activeTabIndex=t},expression:"activeTabIndex"}},e._l(e.config,(function(t,a){return s("b-tab",{key:a,attrs:{"title-link-class":"tab-title",title:t.name}},[s("ConfigTable",{attrs:{initialConfigSection:a},on:{invalidJson:function(t){e.inputValid=!1},validJson:function(t){e.inputValid=!0}}})],1)})),1):e._e()],1),0!==Object.keys(e.config).length&&e.canUpdateSettings?s("b-card",[s("b-button",{attrs:{variant:"primary",disabled:!e.inputValid},on:{click:function(t){e.showMigrationModal=!0}}},[e._v("Find migrations")]),s("b-button",{attrs:{variant:"primary",disabled:!e.inputValid},on:{click:e.updateConfig}},[e._v("Update")])],1):e._e(),s("transition",{attrs:{name:"modal"}},[e.showModal?s("UpdateReportModal",{attrs:{updateReport:e.updateConfigReport},on:{updateReportModalClosed:function(t){e.showModal=!1}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showMigrationModal?s("MigrationModal",{on:{migrationModalClosed:function(t){e.showMigrationModal=!1,e.getConfig()}}}):e._e()],1)],1)},Ne=[],Ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"config-table"},[s("b-table",{attrs:{striped:"",hover:"","sticky-header":"36em",responsive:"",fixed:"","head-variant":"light",items:e.displayConfig,fields:e.tableHeaders},scopedSlots:e._u([{key:"cell(property)",fn:function(t){return[s("div",{staticClass:"tab-cell"},[e._v(e._s(t.item.property))])]}},{key:"cell(value)",fn:function(t){return["object"!==typeof t.item.value||null===t.item.value?s("div",[(""+t.item.value).length>70?s("b-form-textarea",{attrs:{size:"sm","max-rows":"6","no-resize":"",disabled:!e.canUpdateSettings||e.isPropertyReadOnly(t.item.property)},on:{blur:function(s){return e.onValueChanged(s.target.value,t.item.property)}},model:{value:t.item.value,callback:function(s){e.$set(t.item,"value",s)},expression:"row.item.value"}}):s("b-form-input",{attrs:{disabled:!e.canUpdateSettings||e.isPropertyReadOnly(t.item.property)},on:{blur:function(s){return e.onValueChanged(s.target.value,t.item.property)}},model:{value:t.item.value,callback:function(s){e.$set(t.item,"value",s)},expression:"row.item.value"}})],1):e._e(),"object"===typeof t.item.value&&t.item.value?s("VJsoneditor",{staticClass:"editor",attrs:{plus:!1,options:{onValidationError:function(t){e.onValidationError(t)},onChangeText:function(s){e.onChangedJsonText(s,t.item.property)},enableTransform:!1,enableSort:!1,statusBar:!1,mainMenuBar:!0,search:!1,navigationBar:!1,mode:"code",onEditable:e.forbidCertainEditions}},model:{value:t.item.value,callback:function(s){e.$set(t.item,"value",s)},expression:"row.item.value"}}):e._e()]}},{key:"cell(description)",fn:function(t){return[s("div",{directives:[{name:"linkified",rawName:"v-linkified"}],staticClass:"tab-cell",domProps:{innerHTML:e._s(t.item.description)}})]}}])})],1)},Je=[],Be=s("bcb2"),qe=s.n(Be),He={name:"ConfigTable",props:{initialConfigSection:String},components:{VJsoneditor:qe.a},data:function(){return{configSection:this.initialConfigSection,tableHeaders:[{key:"property",label:"Property",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"},{key:"value",label:"Value",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"},{key:"description",label:"Description",thStyle:{"text-align":"center","min-width":"100px"},class:"tab-cell"}]}},computed:{canUpdateSettings:()=>Q.canUpdateSettings(),config:function(){return G.state.config[this.configSection].settings},displayConfig:function(){return Object.keys(this.config).map(function(e){const t=this.config[e].description?this.config[e].description:null;let s=this.config[e];return Object.prototype.hasOwnProperty.call(s,"value")&&(s=s.value),"boolean"===typeof s||null===s?s=String(s):this.isJSON(s)&&(s=JSON.parse(s)),{property:e,value:s,description:t}}.bind(this))}},methods:{isPropertyReadOnly:function(e){return["TEMPLATE_VERSION","REGISTER_ADMIN_KEY"].includes(e)},forbidCertainEditions:function(e){return!!this.canUpdateSettings&&("description"!==e.field&&(!e.field||{field:!1,value:!0}))},onValueChanged:function(e,t){this.isJSON(e)&&(e=JSON.parse(e)),"null"===e&&(e=null),this.config[t].value=e},onChangedJsonText:function(e,t){(this.isJSON(e)||"object"===typeof e)&&(this.config[t].value=JSON.parse(e),this.$emit("validJson"))},onValidationError:function(e){e&&e.length>0&&this.$emit("invalidJson")},isJSON:function(e){try{JSON.parse(e)}catch(t){return!1}return!0}}},ze=He,We=(s("1581"),Object(M["a"])(ze,Ve,Je,!1,null,"503df1e2",null)),Ge=We.exports,Ke=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{on:{close:function(t){return e.$emit("updateReportModalClosed")}}},[s("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Update report")]),s("div",{attrs:{slot:"body"},slot:"body"},[Object.keys(e.updateReport.successes).length>0?s("div",[s("h4",[e._v("Successes")]),s("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.successes}})],1):e._e(),Object.keys(e.updateReport.failures).length>0?s("div",[s("h4",[e._v("Failures")]),s("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.failures}})],1):e._e()])])},Qe=[],Ye={name:"UpdateReportModal",components:{Modal:P},props:{updateReport:{}},computed:{successes:function(){return this.updateReport.successes},failures:function(){return this.updateReport.failures}}},Xe=Ye,Ze=(s("4379"),Object(M["a"])(Xe,Ke,Qe,!1,null,"509193a6",null)),et=Ze.exports,tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"migration-platform-modal"},[s("Modal",{on:{close:function(t){return e.$emit("migrationModalClosed")}}},[s("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Migrate platform")]),s("div",{attrs:{slot:"body"},slot:"body"},[e.hasMigrations()?s("div",[s("h4",[e._v("Available migrations")]),s("b-table",{attrs:{hover:"",fixed:"","head-variant":"light",items:e.migrations}})],1):e._e(),e.hasMigrations()||null!=e.error?e._e():s("div",[s("h4",[e._v("No available migration")]),e._v(" There are no available migrations."),s("br"),e._v(' If you have just performed a migration, close this window and click on "Update", at the bottom right of the "Platform configuration" tab to apply the migration to Pryv.io services. ')]),null!=e.error?s("div",[s("h4",[e._v("Error while fetching migrations")]),e._v(" "+e._s(e.error.message)+" ")]):e._e(),s("div",{staticClass:"modal-footer"},[s("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.$emit("migrationModalClosed")}}},[e._v(" Close ")]),e.hasMigrations()?s("div",[s("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.showApplyMigrationConfirmationModal=!0}}},[e._v(" Apply migrations ")])],1):e._e()],1)]),s("div",{attrs:{slot:"footer"},slot:"footer"})]),e.showLoader?s("loader",{attrs:{loading:e.showLoader}}):e._e(),s("transition",{attrs:{name:"modal"}},[e.showApplyMigrationConfirmationModal?s("ConfirmationModal",{attrs:{text:e.migrationConfirmationMsg()},on:{close:function(t){e.showApplyMigrationConfirmationModal=!1},confirm:function(t){return e.applyMigrations()}}}):e._e()],1)],1)},st=[],at={name:"MigrationModal",components:{Modal:P,Loader:B,ConfirmationModal:Oe},props:{user:{}},data:function(){return{migrations:[],error:null,showLoader:!1,showApplyMigrationConfirmationModal:!1,num:12}},async created(){await this.getAvailableMigrations()},methods:{hasMigrations:function(){return console.log("running hasMig",null!=this.migrations&&this.migrations.length>0),null!=this.migrations&&this.migrations.length>0},lastMigration:function(){return console.log("runnin lastMig"),this.hasMigrations()?(console.log("lookin for last mig",this.migrations),this.migrations[this.migrations.length-1].versionTo):(console.log("last mig not found"),"<issue fetching migrations>")},migrationConfirmationMsg:function(){return`Are you sure you want to migration the platform configuration file to version: ${this.lastMigration()}?`},getAvailableMigrations:async function(){this.showLoader=!0;try{const e=await f.a.get("/admin/migrations");this.migrations=e.data.migrations,console.log("got migrations",this.migrations),this.error=null}catch(e){e&&e.response&&e.response.data&&e.response.data.error&&e.response.data.error.message?this.error=e.response.data.error:this.error=e}finally{this.showLoader=!1}},applyMigrations:async function(){this.showLoader=!0;try{const e=await f.a.post("/admin/migrations/apply");this.migrations=e.data.migrations,this.error=null,this.showApplyMigrationConfirmationModal=!1,await this.getAvailableMigrations()}catch(e){e&&e.response&&e.response.data&&e.response.data.error&&e.response.data.error.message?this.error=e.response.data.error:this.error=e}finally{this.showLoader=!1}}}},ot=at,rt=(s("bb3f"),Object(M["a"])(ot,tt,st,!1,null,"116296b4",null)),nt=rt.exports,it={name:"Config",components:{ConfigTable:Ge,UpdateReportModal:et,MigrationModal:nt,Loader:B},data:()=>({loadFailed:!1,updateFailed:!1,showModal:!1,showMigrationModal:!1,updateConfigReport:{},updateInProgress:!1,loadInProgress:!1,inputValid:!0}),computed:{config:()=>G.state.config,canUpdateSettings:()=>Q.canUpdateSettings(),activeTabIndex:{get:function(){return Object.keys(G.state.config).findIndex(e=>"SERVICE_INFORMATION_SETTINGS"===e)},set:function(){}}},methods:{getConfig:function(){G.state.config={},this.loadInProgress=!0,f.a.get("/admin/settings").then(e=>{if(!e.data||null==!e.data.settings||0===Object.keys(e.data.settings).length)throw new Error;G.state.config=e.data.settings}).catch(e=>{Ie(e,this)||(this.loadFailed=!0)}).finally(()=>{this.loadInProgress=!1})},updateConfig:function(){this.updateInProgress=!0,this.updateFailed=!1,f.a.put("/admin/settings",G.state.config).then(()=>f.a.post("/admin/notify",{})).then(e=>{if(null==e.data||null==e.data.successes||null==e.data.failures)throw new Error;this.updateConfigReport=e.data,this.showModal=!0}).catch(()=>{this.updateFailed=!0}).finally(()=>{this.updateInProgress=!1})},resetFailureIndicators:function(){this.loadFailed=!1,this.updateFailed=!1}},beforeMount(){this.getConfig()}},lt=it,dt=(s("a5cf"),Object(M["a"])(lt,je,Ne,!1,null,"63978a76",null)),ct=dt.exports,ut=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-row",{attrs:{"align-h":"center"}},[s("b-col",{attrs:{cols:"9",md:"5",sm:"9",lg:"5"}},[s("div",{staticClass:"login"},[s("h1",[e._v("Administration Panel")]),s("h3",[e._v("Please log in")]),s("b-card",[s("b-form",{on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[s("b-form-group",{attrs:{"label-for":"username",label:"Username"}},[s("b-form-input",{attrs:{required:"",type:"text",name:"username",id:"username",placeholder:"Username"},on:{input:function(t){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),s("b-form-group",{attrs:{"label-for":"password",label:"Password"}},[s("b-form-input",{attrs:{required:"",type:"password",name:"password",id:"password",placeholder:"Password"},on:{input:function(t){e.loginFailed=!1,e.loginRequestFailed=!1}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),s("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v("Login")])],1)],1),e.loginFailed?s("b-card",[s("div",{staticClass:"failure-msg"},[e.loginRequestFailed?e._e():s("p",[e._v(" Incorrect credentials. Please verify your input ")]),e.loginRequestFailed?s("p",[e._v(" Unable to connect to the server. Please try again later ")]):e._e()])]):e._e(),e.loginInProgress?s("loader",{attrs:{loading:e.loginInProgress}}):e._e()],1)])],1)},mt=[],ft=s("0b16"),pt=s.n(ft),ht={name:"Login",components:{Loader:B},data:()=>({username:"",password:"",loginFailed:!1,loginRequestFailed:!1,loginInProgress:!1,serverUrl:""}),created(){const e=this.getDomainFromQueryParams();this.serverUrl=null!=e?e:"https://lead."+this.getDomainFromUrl()},methods:{getDomainFromQueryParams(){const e=new URL(window.location.href);return e.searchParams.get("pryvLeaderUrl")},getDomainFromUrl(){const e=new URL(window.location.href),t=e.hostname;return t.substring(t.indexOf(".")+1)},login:function(){this.loginInProgress=!0,f.a.post(pt.a.resolve(this.serverUrl,"/auth/login"),{username:this.username,password:this.password}).then(e=>{if(!e.data||0===Object.keys(e.data).length||!e.data.token)throw new Error;localStorage.setItem("serverUrl",this.serverUrl),localStorage.setItem("token",e.data.token);const t=v()(e.data.token);localStorage.setItem("permissions",JSON.stringify(t.permissions)),localStorage.setItem("username",t.username),G.state.currentUser={username:t.username,permissions:t.permissions},f.a.defaults.baseURL=this.serverUrl,f.a.defaults.headers.common["authorization"]=e.data.token,this.$emit("loggedIn"),this.$router.push("/")}).catch(e=>{(e&&e.response&&e.response.status&&e.response.status>=500||"Network Error"===e.message)&&(this.loginRequestFailed=!0),this.loginFailed=!0}).finally(()=>{this.loginInProgress=!1})}}},gt=ht,vt=(s("c8b8"),Object(M["a"])(gt,ut,mt,!1,null,"03e21e82",null)),bt=vt.exports,wt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-row",{attrs:{"align-h":"center"}},[s("b-col",{attrs:{cols:"9",md:"5",sm:"9",lg:"5"}},[s("div",{staticClass:"platform-users"},[s("h2",[e._v("Platform Users")]),s("b-card",[s("b-form",{on:{submit:function(t){return t.preventDefault(),e.getPlatformUser(t)}}},[s("b-form-input",{attrs:{required:"",type:"text",name:"username",id:"username",placeholder:"Username"},on:{input:function(t){e.userNotFound=!1}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),s("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v(" Find ")])],1)],1),e.hasUser?s("b-card",[s("b-form",{on:{submit:function(t){t.preventDefault(),e.showDeleteConfirmationModal=!0},reset:function(t){t.preventDefault(),e.showModifyConfirmationModal=!0}}},[e._l(Object.keys(e.user),(function(t){return s("b-form-group",{key:t,attrs:{"label-for":""+t,label:t+":","label-cols":"4","label-cols-lg":"4","label-size":"md","label-class":"font-weight-normal","label-align":"right"}},[s("b-form-input",{attrs:{type:"text",name:""+t,id:""+t,disabled:""},model:{value:e.user[t],callback:function(s){e.$set(e.user,t,s)},expression:"user[prop]"}})],1)})),e.canModifyPlatformUsers?s("b-button",{attrs:{variant:"secondary",type:"reset"}},[e._v(" Deactivate MFA ")]):e._e(),e.canDeletePlatformUsers?s("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v(" Delete ")]):e._e()],2)],1):e._e(),e.userNotFound?s("b-card",[s("div",{staticClass:"failure-msg"},[e._v(" User not found ")])]):e._e(),e.showLoader?s("loader",{attrs:{loading:e.showLoader}}):e._e(),s("transition",{attrs:{name:"modal"}},[e.showDeleteConfirmationModal?s("ConfirmationWithInputModal",{attrs:{validConfirmationInput:e.user.username},on:{close:function(t){e.showDeleteConfirmationModal=!1},confirm:function(t){return e.deletePlatformUser()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showModifyConfirmationModal?s("ConfirmationWithInputModal",{attrs:{validConfirmationInput:e.user.username},on:{close:function(t){e.showModifyConfirmationModal=!1},confirm:function(t){return e.deleteMfaPlatformUser()}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showUserDeletedModal?s("OperationSuccessfulModal",{attrs:{text:e.userDeletedText},on:{close:function(t){e.showUserDeletedModal=!1}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showMfaDeletedModal?s("OperationSuccessfulModal",{attrs:{text:e.mfaDeletedText},on:{close:function(t){e.showMfaDeletedModal=!1}}}):e._e()],1),s("transition",{attrs:{name:"modal"}},[e.showFailureModal?s("OperationFailedModal",{on:{close:function(t){e.showFailureModal=!1}}}):e._e()],1)],1)])],1)},Ct=[],yt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"confirmation-modal-mask"},[s("div",{staticClass:"confirmation-modal-wrapper"},[s("div",{staticClass:"confirmation-modal-container"},[s("div",{staticClass:"confirmation-modal-body"},[s("div",{staticClass:"confirmation-close-button",on:{click:function(t){return e.$emit("close")}}},[e._v("x")]),s("div",{staticClass:"confirmation-text"},[e._v(" Please type "),s("b",[e._v(e._s(e.validConfirmationInput))]),e._v(" to confirm. ")])]),s("b-form",[s("b-form-input",{attrs:{required:"",type:"text",name:"confirmation-input",id:"confirmation-input"},model:{value:e.confirmationInput,callback:function(t){e.confirmationInput=t},expression:"confirmationInput"}})],1),s("div",{staticClass:"confirmation-modal-footer"},[s("b-button",{attrs:{variant:"outline-primary"},on:{click:function(t){return e.$emit("close")}}},[e._v(" Cancel ")]),s("b-button",{attrs:{variant:"primary",disabled:e.validConfirmationInput!==e.confirmationInput},on:{click:function(t){return e.$emit("confirm")}}},[e._v("Confirm")]),s("br")],1)],1)])])},Mt=[],_t={name:"ConfirmationWithInputModal",props:{validConfirmationInput:String},data:()=>({confirmationInput:""})},Pt=_t,Ut=(s("c5e6"),Object(M["a"])(Pt,yt,Mt,!1,null,"5367c45c",null)),kt=Ut.exports,xt={name:"PlatformUsers",components:{Loader:B,OperationSuccessfulModal:I,OperationFailedModal:D,ConfirmationWithInputModal:kt},data:()=>({username:"",user:{},showDeleteConfirmationModal:!1,showModifyConfirmationModal:!1,deleteConfirmationMsg:"Enter username to confirm",showUserDeletedModal:!1,showMfaDeletedModal:!1,userDeletedText:"User deleted successfully",mfaDeletedText:"User MFA deactivated successfully",showFailureModal:!1,showLoader:!1,userNotFound:!1}),computed:{canModifyPlatformUsers:()=>Q.canModifyPlatformUsers(),canDeletePlatformUsers:()=>Q.canDeletePlatformUsers(),hasUser:function(){return Object.keys(this.user).length>0}},methods:{getPlatformUser:function(){this.showLoader=!0,f.a.get("/platform-users/"+this.username).then(e=>{if(!e.data||0===Object.keys(e.data).length)throw new Error;this.user=e.data.user}).catch(e=>{Ie(e,this)||(this.userNotFound=!0)}).finally(()=>{this.showLoader=!1})},deletePlatformUser(){this.showDeleteConfirmationModal=!1,this.showLoader=!0,f.a.delete("/platform-users/"+this.username).then(()=>{this.user={},this.showUserDeletedModal=!0}).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)},deleteMfaPlatformUser(){this.showModifyConfirmationModal=!1,this.showLoader=!0,f.a.delete(`/platform-users/${this.username}/mfa`).then(()=>{this.showMfaDeletedModal=!0}).catch(e=>{Ie(e,this)||(this.showFailureModal=!0)}).finally(()=>this.showLoader=!1)}}},St=xt,Ot=(s("d725"),Object(M["a"])(St,wt,Ct,!1,null,"6189ffcf",null)),It=Ot.exports;a["default"].use(re["a"]);const $t=[{path:"/",name:"Home",component:ue},{path:"/login",name:"Login",component:bt},{path:"/admin-users",name:"AdminUsers",component:Ae,beforeEnter:(e,t,s)=>{Q.canReadAdminUsers()||s(!1),s()}},{path:"/platform-users",name:"PlatformUsers",component:It,beforeEnter:(e,t,s)=>{Q.canReadPlatformUsers()||s(!1),s()}},{path:"/platform-config",name:"Config",component:ct,beforeEnter:(e,t,s)=>{Q.canReadSettings()||s(!1),s()}}],Rt=new re["a"]({routes:$t});var Ft=Rt;a["default"].config.productionTip=!1,new a["default"]({router:Ft,render:e=>e(oe)}).$mount("#app")},6:function(e,t){},6586:function(e,t,s){"use strict";var a=s("d449"),o=s.n(a);o.a},"6a9e":function(e,t,s){},"6cac":function(e,t,s){"use strict";var a=s("875b"),o=s.n(a);o.a},7:function(e,t){},"73c6":function(e,t,s){},"7af1":function(e,t,s){},"7bca":function(e,t,s){"use strict";var a=s("9b10"),o=s.n(a);o.a},8:function(e,t){},"85ec":function(e,t,s){},"875b":function(e,t,s){},9:function(e,t){},"9b10":function(e,t,s){},"9da0":function(e,t,s){},a5cf:function(e,t,s){"use strict";var a=s("5126"),o=s.n(a);o.a},b062:function(e,t,s){"use strict";var a=s("bb0b"),o=s.n(a);o.a},b24f:function(e,t,s){"use strict";var a=s("fced"),o=s.n(a);o.a},bb0b:function(e,t,s){},bb3f:function(e,t,s){"use strict";var a=s("3a30"),o=s.n(a);o.a},c5e6:function(e,t,s){"use strict";var a=s("0ea4"),o=s.n(a);o.a},c8b8:function(e,t,s){"use strict";var a=s("cf90"),o=s.n(a);o.a},cf05:function(e,t,s){e.exports=s.p+"img/logo.54cacaa3.png"},cf90:function(e,t,s){},d449:function(e,t,s){},d609:function(e,t,s){"use strict";var a=s("9da0"),o=s.n(a);o.a},d725:function(e,t,s){"use strict";var a=s("dfc5"),o=s.n(a);o.a},dfc5:function(e,t,s){},e888:function(e,t,s){"use strict";var a=s("ea20"),o=s.n(a);o.a},ea20:function(e,t,s){},f576:function(e,t,s){},f890:function(e,t,s){"use strict";var a=s("6a9e"),o=s.n(a);o.a},fced:function(e,t,s){}});
//# sourceMappingURL=app.5746df44.js.map